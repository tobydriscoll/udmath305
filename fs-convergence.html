<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-05-08T21:20:35-04:00    *-->
<!--*                                    *-->
<!--*   http://mathbook.pugetsound.edu   *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Convergence</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script src="https://sagecell.sagemath.org/static/jquery.min.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']],
    },
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://aimath.org/mathbook/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script src="https://aimath.org/knowl.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.sticky.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.1/pretext.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/stylesheets/mathbook-3.css" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/mathbook-add-on2.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="mathbook-delaware.css">
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(  \newcommand{\dd}[2]{\frac{d #1}{d #2}}
  \renewcommand{\Re}{\text{Re}}
  \renewcommand{\Im}{\text{Im}}
  \newcommand{\Span}[1]{\langle#1\rangle}
  \newcommand{\spr}[1]{^{(#1)}}
  \newcommand{\dd}[2]{\frac{d #1}{d #2}}
  \newcommand{\ddd}[2]{\frac{d^2 #1}{d #2^2}}
  \newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
  \newcommand{\ppp}[2]{\frac{\partial^2 #1}{\partial #2^2}}
  \newcommand{\norm}[1]{\left\| #1 \right\|}
  \newcommand{\det}{\operatorname{det}}
  \newcommand{\bzero}{\boldsymbol{0}}
  \newcommand{\bu}{\mathbf{u}}
  \newcommand{\bA}{\mathbf{A}}
  \newcommand{\bB}{\mathbf{B}}
  \newcommand{\bC}{\mathbf{C}}
 \newcommand{\bD}{\mathbf{D}}
  \newcommand{\bI}{\mathbf{I}}
  \newcommand{\bV}{\mathbf{V}}
\newcommand{\bff}{\mathbf{f}}
  \newcommand{\bx}{\mathbf{x}}
  \newcommand{\by}{\mathbf{y}}
  \newcommand{\bb}{\mathbf{b}}
  \newcommand{\bu}{\mathbf{u}}
  \newcommand{\bv}{\mathbf{v}}
  \newcommand{\bw}{\mathbf{w}}
  \newcommand{\bc}{\mathbf{c}}
  \newcommand{\bz}{\mathbf{z}}
  \newcommand{\inprod}[2]{\langle #1, #2 \rangle}
  \newcommand{\twovec}[2]{\begin{bmatrix}#1\\#2\end{bmatrix}}
  \newcommand{\twodet}[4]{\begin{vmatrix}#1 \amp #2\\#3 \amp #4\end{vmatrix}}
  \newcommand{\twomat}[4]{\begin{bmatrix}#1 \amp #2\\#3 \amp #4\end{bmatrix}}
  \newcommand{\twodiag}[2]{\begin{bmatrix} #1 \amp 0 \\ 0 \amp #2 \end{bmatrix}}
  \newcommand{\fourdiag}[3]{\begin{bmatrix} #1 \amp  \amp \amp  \\                    \amp #2 \amp  \amp  \\  \amp \amp \ddots \amp \\  \amp  \amp  \amp #3 \end{bmatrix}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="notes.html"><span class="title">Notes for MATH 305</span></a></h1>
<p class="byline">Toby Driscoll</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="fs-realimag.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="fourier-series.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="fourier-series.html" title="Next">Next</a></span></div>
<button class="sidebar-right-toggle-button button active">Annotations</button>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="fs-realimag.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="fourier-series.html" title="Up">Up</a><a class="next-button button toolbar-item" href="fourier-series.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><h2 class="link"><a href="index.html" data-scroll="index"><span class="title">Front Matter</span></a></h2>
<ul><li><a href="preface-1.html" data-scroll="preface-1">Preface</a></li></ul>
<h2 class="link"><a href="first-order-ode.html" data-scroll="first-order-ode"><span class="codenumber">1</span> <span class="title">First-order ODEs</span></a></h2>
<ul>
<li><a href="linearity.html" data-scroll="linearity">Introduction</a></li>
<li><a href="exponentials.html" data-scroll="exponentials">Exponentials</a></li>
<li><a href="first-linear-ode.html" data-scroll="first-linear-ode">Linear ODEs</a></li>
<li><a href="first-linear-const.html" data-scroll="first-linear-const">Linear, constant-coefficients</a></li>
<li><a href="complex-exp.html" data-scroll="complex-exp">Using complex numbers</a></li>
<li><a href="variable-coeffs.html" data-scroll="variable-coeffs">Linear, variable coefficient</a></li>
<li><a href="first-order-models.html" data-scroll="first-order-models">Modeling with first-order ODEs</a></li>
<li><a href="steady-states.html" data-scroll="steady-states">Steady states</a></li>
<li><a href="logistic-equation.html" data-scroll="logistic-equation">Logistic equation</a></li>
<li><a href="separable.html" data-scroll="separable">Separable equations</a></li>
<li><a href="laplace-solutions.html" data-scroll="laplace-solutions">Laplace transform methods</a></li>
</ul>
<h2 class="link"><a href="second-order-ode.html" data-scroll="second-order-ode"><span class="codenumber">2</span> <span class="title">Second-order ODEs</span></a></h2>
<ul>
<li><a href="so-simple-harmonic.html" data-scroll="so-simple-harmonic">Simple harmonic motion</a></li>
<li><a href="so-complex-exponentials.html" data-scroll="so-complex-exponentials">Complex exponentials</a></li>
<li><a href="so-constant-coefficients.html" data-scroll="so-constant-coefficients">Constant coefficients</a></li>
<li><a href="so-forced-oscillators.html" data-scroll="so-forced-oscillators">Exponentially forced oscillators</a></li>
<li><a href="so-higher-order.html" data-scroll="so-higher-order">Higher-order ODEs</a></li>
<li><a href="so-applications.html" data-scroll="so-applications">Applications of oscillators</a></li>
<li><a href="so-general-forcing.html" data-scroll="so-general-forcing">Other forcing functions</a></li>
<li><a href="so-laplace.html" data-scroll="so-laplace">Laplace transform methods</a></li>
<li><a href="so-laplace-repeated.html" data-scroll="so-laplace-repeated">Repeated and complex poles</a></li>
<li><a href="so-convolutions.html" data-scroll="so-convolutions">Convolutions</a></li>
</ul>
<h2 class="link"><a href="two-dimensional-systems.html" data-scroll="two-dimensional-systems"><span class="codenumber">3</span> <span class="title">2D systems</span></a></h2>
<ul>
<li><a href="twod-slope-fields.html" data-scroll="twod-slope-fields">Slope fields</a></li>
<li><a href="twod-fixed-points.html" data-scroll="twod-fixed-points">Linear 2D systems</a></li>
<li><a href="twod-linearization.html" data-scroll="twod-linearization">Linearization</a></li>
</ul>
<h2 class="link"><a href="matrix-algebra.html" data-scroll="matrix-algebra"><span class="codenumber">4</span> <span class="title">Matrix algebra</span></a></h2>
<ul>
<li><a href="ma-rows-columns.html" data-scroll="ma-rows-columns">Rows and columns</a></li>
<li><a href="ma-elimination.html" data-scroll="ma-elimination">Elimination for linear systems</a></li>
<li><a href="ma-multiplication.html" data-scroll="ma-multiplication">Multiplying matrices</a></li>
<li><a href="ma-inverses.html" data-scroll="ma-inverses">Matrix inverses</a></li>
<li><a href="ma-nullspace.html" data-scroll="ma-nullspace">Nullspaces</a></li>
<li><a href="ma-eigenvalues.html" data-scroll="ma-eigenvalues">Eigenvalues</a></li>
<li><a href="ma-diagonalization.html" data-scroll="ma-diagonalization">Diagonalization</a></li>
<li><a href="ma-linearODE.html" data-scroll="ma-linearODE">Linear ODE systems</a></li>
<li><a href="ma-exponential.html" data-scroll="ma-exponential">Matrix exponential</a></li>
</ul>
<h2 class="link"><a href="fourier-series.html" data-scroll="fourier-series"><span class="codenumber">5</span> <span class="title">Fourier series</span></a></h2>
<ul>
<li><a href="fs-orthgonality.html" data-scroll="fs-orthgonality">Main idea</a></li>
<li><a href="fs-realimag.html" data-scroll="fs-realimag">Special forms</a></li>
<li><a href="fs-convergence.html" data-scroll="fs-convergence" class="active">Convergence</a></li>
</ul>
<h2 class="link"><a href="fourier-series.html" data-scroll="fourier-series"><span class="codenumber">6</span> <span class="title">Boundary-value problems</span></a></h2>
<ul>
<li><a href="bvp-boundaries.html" data-scroll="bvp-boundaries">Boundaries</a></li>
<li><a href="bvp-eigenfunctions.html" data-scroll="bvp-eigenfunctions">Eigenfunctions</a></li>
<li><a href="bvp-diffusion.html" data-scroll="bvp-diffusion">Diffusion equation</a></li>
<li><a href="bvp-separation.html" data-scroll="bvp-separation">Separation of variables</a></li>
<li><a href="bvp-nondim.html" data-scroll="bvp-nondim">Nondimensionalization</a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://mathbook.pugetsound.edu">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="mathbook-content"><section class="section" id="fs-convergence"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">5.3</span> <span class="title">Convergence</span>
</h2>
<a href="fs-convergence.html" class="permalink">¶</a><section class="introduction" id="introduction-25"><p id="p-480">We rather breezily derived the formulas</p>
<div class="displaymath">
\begin{equation*}
u_k(x) = \frac{1}{\sqrt{2\pi}} e^{ikx}, \quad k=0,\pm 1,\pm 2,\dots\text{,}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
f(x) = \sum_{k=-\infty}^\infty c_k u_k(x),\quad c_k = \int_{-\pi}^\pi \overline{u_k}(x) f(x)\, dx\text{,}
\end{equation*}
</div>
<p>without regard to whether the infinite series implied here converges to the values of \(f\text{,}\) or indeed at all. Fortunately, only a reasonable assumption on \(f\) is needed. In particular, we will assume that \(f\) is continuous on each of a finite collection of closed intervals that combine to make \([-\pi,\pi]\text{.}\) That is, the function is allowed to have a finite number of jump discontinuities. We call such a function <dfn class="terminology">piecewise continuous</dfn>.</p>
<article class="theorem-like" id="theorem-6"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">5.3.1</span> <span class="title">Convergence of Fourier series</span>
</h6>
<p id="p-481">Suppose \(f\) is a piecewise continuous function on \([-\pi,\pi]\text{.}\) Then the Fourier series above converges (1) to \(f(x)\) at all \(x\in(-\pi,\pi)\) at which \(f\) is continuous, (2) to</p>
<div class="displaymath">
\begin{equation*}
\frac{1}{2} [ f(x^-) + f(x^+) ] 
\end{equation*}
</div>
<p>at all \(x\in(-\pi,\pi)\text{,}\) where \(f(x^\pm)\) are the one-sided limits of \(f\) at \(x\text{,}\) and (3) to</p>
<div class="displaymath">
\begin{equation*}
\frac{1}{2} [ f(\pi^-) + f(-\pi^+) ] 
\end{equation*}
</div>
<p>at \(x=\pm\pi\text{.}\)</p></article><p id="p-482">Each partial (i.e., truncated) sum of the Fourier series is a continuous function that is periodic over \([-\pi,\pi]\text{,}\) and its limit has the same property. It does the best we could hope for, getting the correct value at every point of continuity and "splitting the difference" at the jumps. These jumps include a lack of periodicity in the original \(f\text{.}\) It might help to think of a Fourier series as being defined on a circle with angle \(\theta \in [-\pi,pi]\text{,}\) rather than a regular interval. No point on the circle is truly distinguished; we just choose to cut it somewhere in order to unroll it onto a line.</p>
<article class="example-like" id="example-69"><a knowl="" class="id-ref" refid="hk-example-69"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">5.3.2</span>
</h6></a></article><div id="hk-example-69" class="hidden-content tex2jax_ignore"><article class="example-like"><p id="p-483">We look at the partial sums that result from restricting to \(|k|\le N\text{,}\) for a few values of \(N\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><pre class="prettyprint lang-matlab">f = @(x) exp(sin(3*x)+cos(4*x)); 

nu = 1/sqrt(2*pi);
c0 = nu*integral(f,-pi,pi);
for k = 1:30
    cplus(k) = nu*integral( @(x) f(x).*exp(-1i*k*x),-pi,pi);
    cminus(k) = nu*integral( @(x) f(x).*exp(1i*k*x),-pi,pi);
end    

x = linspace(-pi,pi,1001)';
s = nu*c0;
N = 4:4:12;
fplot(f,[-pi pi],'k','linewid',2), hold on
for k = 1:30
   s = s + nu*cplus(k)*exp(1i*k*x) + nu*cminus(k)*exp(-1i*k*x);
   if any(k==N)
       plot(x,s)
   end
end
</pre></div>
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><img src="matlab/fs_converge_smooth.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div>
<p id="p-484">If we were to let \(N\) continue to grow, the curve would very soon become indistinguishable from the original function, to plotting accuracy.</p></article></div></section><section class="subsection" id="subsection-80"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">5.3.1</span> <span class="title">The Gibbs phenomenon</span>
</h3>
<p id="p-485">Consider the innocent-looking \(f(x)=x\text{.}\) We can compute the coefficients of the sine series over \([0,\pi]\) exactly,</p>
<div class="displaymath">
\begin{align*}
b_k = \frac{2}{\pi} \int_{0}^{\pi} x \sin(kx) \, dx \amp = \frac{2}{\pi k^2} \left[ \sin(kx)-kx\cos(kx) \right]_0^\pi \\
\amp = (-1)^{k+1} \cdot \frac{2}{k}\text{.}
\end{align*}
</div>
<p>The partial sums are interesting.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><pre class="prettyprint lang-matlab">x = linspace(-2*pi,2*pi,1001)';
s = 0;
N = 5:5:15;
clf
plot(x,x,'k','linewid',2), hold on
for k = 1:30
   s = s + (-1)^(k+1)*(2/k)*sin(k*x);
   if any(k==N)
       plot(x,s)
   end
end
</pre></div>
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><img src="matlab/fs_sawtooth.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div>
<p id="p-486">The partial sums are \(2\pi\) periodic, so they are approximating not \(f\) everywhere but a "sawtooth" variation: first \(f\) is extended oddly to \([-\pi,0]\text{,}\) then the result is repeated periodically over and over to make the sawtooth. Note also that the partial sums are zero at \(x=\pm \pi\text{,}\) because that is the average of the values of (extended) \(f\) at those two points. In effect, \(f\) is "supposed to be" periodic, and the Fourier series can't adjust for the fact that it is not.</p>
<p id="p-487">But the most dramatic feature of the picture above is that the errors are visibly much larger than in our first example. Let's zoom in toward \(x=\pi\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><pre class="prettyprint lang-matlab">x = linspace(0.8*pi,pi,1001)';
s = 0;
N = 5:5:30;
clf
plot(x,x,'k','linewid',2), hold on
for k = 1:30
   s = s + (-1)^(k+1)*(2/k)*sin(k*x);
   if any(k==N)
       plot(x,s)
   end
end
ylim([2 3.8])
</pre></div>
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><img src="matlab/fs_sawtooth_zoom.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div>
<p id="p-488">The convergence theorem tells us that if we look at one particular value of \(x\text{,}\) then the sums converge to the original line. That's true. But each partial sum keeps shooting past the target back and forth, by an amount that does not decrease as \(N\to\infty\text{.}\)</p>
<p id="p-489">This overshooting behavior is called the <dfn class="terminology">Gibbs phenomenon</dfn>. It's manifested for any function with a jump discontinuity, including (as in this case) at the point of periodicity. The pointwise convergence rate as a function of \(N\) is rather slow, and every finite approximation has the overshoot/ringing behavior. You can consider it the price that must be paid when using infinitely differentiable functions (sines and cosines) to approximate one with a discontinuity.</p></section></section></div></main>
</div>
</body>
</html>
