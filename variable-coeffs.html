<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-03-07T13:55:07-05:00    *-->
<!--*                                    *-->
<!--*   http://mathbook.pugetsound.edu   *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Linear, variable coefficient</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script src="https://sagecell.sagemath.org/static/jquery.min.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']],
    },
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://aimath.org/mathbook/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script src="https://aimath.org/knowl.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.sticky.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.1/pretext.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/stylesheets/mathbook-3.css" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/mathbook-add-on2.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="mathbook-delaware.css">
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\newcommand{\dd}[2]{\frac{d #1}{d #2}}
\renewcommand{\Re}{\text{Re}}
\renewcommand{\Im}{\text{Im}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="notes.html"><span class="title">Notes for MATH 305</span></a></h1>
<p class="byline">Toby Driscoll</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="complex-exp.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="first-order-ode.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="first-order-models.html" title="Next">Next</a></span></div>
<button class="sidebar-right-toggle-button button active">Annotations</button>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="complex-exp.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="first-order-ode.html" title="Up">Up</a><a class="next-button button toolbar-item" href="first-order-models.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><h2 class="link"><a href="index.html" data-scroll="index"><span class="title">Front Matter</span></a></h2>
<ul><li><a href="preface-1.html" data-scroll="preface-1">Preface</a></li></ul>
<h2 class="link"><a href="first-order-ode.html" data-scroll="first-order-ode"><span class="codenumber">1</span> <span class="title">First-order ODEs</span></a></h2>
<ul>
<li><a href="linearity.html" data-scroll="linearity">Introduction</a></li>
<li><a href="exponentials.html" data-scroll="exponentials">Exponentials</a></li>
<li><a href="first-linear-ode.html" data-scroll="first-linear-ode">Linear ODEs</a></li>
<li><a href="first-linear-const.html" data-scroll="first-linear-const">Linear, constant-coefficients</a></li>
<li><a href="complex-exp.html" data-scroll="complex-exp">Using complex numbers</a></li>
<li><a href="variable-coeffs.html" data-scroll="variable-coeffs" class="active">Linear, variable coefficient</a></li>
<li><a href="first-order-models.html" data-scroll="first-order-models">Modeling with first-order ODEs</a></li>
<li><a href="steady-states.html" data-scroll="steady-states">Steady states</a></li>
<li><a href="logistic-equation.html" data-scroll="logistic-equation">Logistic equation</a></li>
<li><a href="separable.html" data-scroll="separable">Separable equations</a></li>
<li><a href="laplace-solutions.html" data-scroll="laplace-solutions">Laplace transform methods</a></li>
</ul>
<h2 class="link"><a href="second-order-ode.html" data-scroll="second-order-ode"><span class="codenumber">2</span> <span class="title">Second-order ODEs</span></a></h2>
<ul>
<li><a href="so-simple-harmonic.html" data-scroll="so-simple-harmonic">Simple harmonic motion</a></li>
<li><a href="so-complex-exponentials.html" data-scroll="so-complex-exponentials">Complex exponentials</a></li>
<li><a href="so-constant-coefficients.html" data-scroll="so-constant-coefficients">Constant coefficients</a></li>
<li><a href="so-forced-oscillators.html" data-scroll="so-forced-oscillators">Exponentially forced oscillators</a></li>
<li><a href="so-higher-order.html" data-scroll="so-higher-order">Higher-order ODEs</a></li>
<li><a href="so-applications.html" data-scroll="so-applications">Applications of oscillators</a></li>
<li><a href="so-general-forcing.html" data-scroll="so-general-forcing">Other forcing functions</a></li>
<li><a href="so-laplace.html" data-scroll="so-laplace">Laplace transform methods</a></li>
<li><a href="so-laplace-repeated.html" data-scroll="so-laplace-repeated">Repeated and complex poles</a></li>
<li><a href="so-convolutions.html" data-scroll="so-convolutions">Convolutions</a></li>
</ul>
<h2 class="link"><a href="qualitative.html" data-scroll="qualitative"><span class="codenumber">3</span> <span class="title">Qualitative analysis</span></a></h2>
<ul>
<li><a href="direction-fields.html" data-scroll="direction-fields">Direction fields</a></li>
<li><a href="planar-stability.html" data-scroll="planar-stability">Planar stability</a></li>
<li><a href="equilibria-linearization.html" data-scroll="equilibria-linearization">Equilibria and linearization</a></li>
</ul>
<h2 class="link"><a href="matrix-algebra.html" data-scroll="matrix-algebra"><span class="codenumber">4</span> <span class="title">Matrix algebra</span></a></h2>
<ul>
<li><a href="linear-equations.html" data-scroll="linear-equations">Linear equations</a></li>
<li><a href="elimination.html" data-scroll="elimination">Solution by elimination</a></li>
<li><a href="matrix-multiplication.html" data-scroll="matrix-multiplication">Matrix multiplication</a></li>
</ul>
<h2 class="link"><a href="linear-ode-systems.html" data-scroll="linear-ode-systems"><span class="codenumber">5</span> <span class="title">Linear ODE systems</span></a></h2>
<ul>
<li><a href="eigenvalues.html" data-scroll="eigenvalues">Eigenvalues and eigenvectors</a></li>
<li><a href="diagonalization.html" data-scroll="diagonalization">Diagonalization</a></li>
<li><a href="linear-system-solutions.html" data-scroll="linear-system-solutions">Solutions of linear ODEs</a></li>
<li><a href="matrix-exponential.html" data-scroll="matrix-exponential">The matrix exponential</a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://mathbook.pugetsound.edu">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="mathbook-content"><section class="section" id="variable-coeffs"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">1.6</span> <span class="title">Linear, variable coefficient</span>
</h2>
<a href="variable-coeffs.html" class="permalink">Â¶</a><p id="p-81"><em class="emphasis">Refer to section 1.6 of the text (pp. 40-42).</em></p>
<p id="p-82">We now consider how to solve a more general first-order linear problem,</p>
<div class="displaymath">
\begin{equation*}
\dd{y}{t} = a(t)y(t) + q(t) \text{.}
\end{equation*}
</div>
<p>One approach is to upgrade the integrating factor \(M=e^{-at}\) we used in <a knowl="./knowl/eq-first-linear-const.html" title="Equation 1.4.1">(1.4.1)</a>. What made that work is that \(M'=-aM\text{.}\) For a nonconstant \(a(t)\text{,}\) the same thing is accomplished by \(M(t) = e^{-b(t)}\text{,}\) so long as \(b'=a\text{.}\) That is, we need \(b(t)\) to be any antiderivative of \(a(t)\text{.}\) With that, we can essentially repeat the same calculation as before:</p>
<div class="displaymath">
\begin{align*}
M(t) y'(t) - a(t) M(t) y(t) \amp = M(t)q(t) \\
\dd{}{t}\bigl[ M(t) y(t) \bigr] \amp = M(t) q(t) \\
M(t) y(t) \amp = M(0) y(0)  +  \int_0^t M(s) q(s)\, ds\text{.}
\end{align*}
</div>
<p>We now pick the antiderivative \(b(t)\) such that \(b(0)=0\text{.}\) That is, let</p>
<div class="displaymath">
\begin{equation*}
M(t) = \exp\left( -\int_0^t a(r)\, dr \right)\text{,}
\end{equation*}
</div>
<p>and \(M(0)=1\text{.}\) Now the solution above becomes</p>
<div class="displaymath">
\begin{equation*}
y(t)  = \exp\left( \int_0^t a(r)\, dr \right) y(0)   +
\int_0^t \exp\left( \int_0^t a(r)\, dr - \int_0^s a(r)\, dr \right)   q(s)\, ds\text{.}
\end{equation*}
</div>
<p id="p-83">This mess inspires the definition</p>
<div class="displaymath">
\begin{equation}
G(s,t) = \exp\left( \int_s^t a(r)\, dr \right)\text{,}\label{eq-growth-factor}\tag{1.6.1}
\end{equation}
</div>
<p>which we call the <dfn class="terminology">growth factor</dfn>. So we have the more manageable</p>
<div class="displaymath">
\begin{equation}
y(t) = G(0,t)y(0) + \int_0^t G(s,t) q(s)\, ds\text{.}\label{eq-fl-solution}\tag{1.6.2}
\end{equation}
</div>
<p>This format takes us back to familiar territory. The total solution has one part (the null solution) that is evolution of the initial value and another (particular solution) that comes from evolution of an impulse of size \(q(s)\) at each time \(0 \le s \lt t\text{.}\) The only difference from the constant-coefficient case is how to express the growth factor.</p>
<p id="p-84">We can summarize finding the solution of a linear first-order ODE as two steps: 1. Integrate the growth rate to get the growth factor. 2. Integrate the product of the growth factor with the forcing function.</p>
<article class="example-like" id="example-9"><a knowl="" class="id-ref" refid="hk-example-9"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">1.6.1</span>
</h6></a></article><div id="hk-example-9" class="hidden-content tex2jax_ignore"><article class="example-like"><p id="p-85">Let's solve \(y'=2y+1\text{,}\) with \(y(0)=6\text{.}\) We have \(a(t)=2\text{,}\) hence \(G(s,t)=\exp[2(t-s)]=e^{2(t-s)}\text{.}\) So the solution is</p>
<div class="displaymath">
\begin{equation*}
e^{2t}\cdot 6 + \int_0^t e^{2(t-s)}\, ds
= 6e^{2t} - \frac{1}{2} \left[ 1 - e^{2t} \right] = - \frac{1}{2} + \frac{13}{2} e^{2t}\text{.}
\end{equation*}
</div>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><pre class="prettyprint lang-matlab">dydt = @(t,y) 2*y + 1;
[t,y] = ode45(dydt,[0,1],6);
plot(t,y)
xlabel('t'), ylabel('y(t)')
</pre></div>
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><img src="matlab/fo_lvc_constant.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div>
<p id="p-86">This example is linear with constant coefficients, so the result is something we have seen before. The point is that the approach we have now is a true generalization, working for all those previous problems as well.</p></article></div>
<article class="example-like" id="example-10"><a knowl="" class="id-ref" refid="hk-example-10"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">1.6.2</span>
</h6></a></article><div id="hk-example-10" class="hidden-content tex2jax_ignore"><article class="example-like"><p id="p-87">To solve \(y'=2ty - t\) with \(y(0)=0\text{,}\) we identify \(a(t)=2t\text{.}\) Hence \(G(s,t)=\exp(t^2-s^2)\text{.}\) Then</p>
<div class="displaymath">
\begin{equation*}
y(t) = \int_0^t (-s) e^{t^2-s^2}\, ds = \frac{1}{2} \left( 1 - e^{t^2} \right)\text{.}
\end{equation*}
</div>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><pre class="prettyprint lang-matlab">dydt = @(t,y) 2*t*y - t;
[t,y] = ode45(dydt,[0,2],0);
plot(t,y)
xlabel('t'), ylabel('y(t)')
</pre></div>
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><img src="matlab/fo_lvc_linear.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div></article></div>
<article class="example-like" id="example-11"><a knowl="" class="id-ref" refid="hk-example-11"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">1.6.3</span>
</h6></a></article><div id="hk-example-11" class="hidden-content tex2jax_ignore"><article class="example-like"><p id="p-88">Consider the problem \(ty' + 2y = 4t^2\text{,}\) with initial value \(y(1)=2\text{.}\) In order to identify this with the standard way we present a linear, first-order ODE, we have to isolate the \(y'\) term to get</p>
<div class="displaymath">
\begin{equation*}
y' = -\frac{2}{t}y + 4t\text{.}
\end{equation*}
</div>
<p>Note that we may need to stay away from \(t=0\text{,}\) where the variable coefficient blows up. Fortunately, it's easy to use the growth factor formula starting from any value of \(t\text{.}\) The growth factor is, as usual,</p>
<div class="displaymath">
\begin{equation*}
G(s,t) = \exp\left( \int_s^t -\frac{2}{r}\, dr \right) = \exp\left( -2 \log(t/s) \right) = \left(\frac{s}{t}\right)^2\text{.}
\end{equation*}
</div>
<p>The solution is</p>
<div class="displaymath">
\begin{align*}
y(t) \amp = G(t,1)y(1) + \int_1^t G(s,t) q(s)\, ds  \\
\amp = 2t^{-2} + \int_1^t \left(\frac{s}{t}\right)^2 4s\, ds \\
\amp = 2t^{-2} + t^{-2}\left[ t^4-1^4 \right] = t^2 + t^{-2} \text{.}
\end{align*}
</div>
<p>We now do see that trying to go backward to time zero would cause the solution to blow up. (That's in the math sense, not the chemical engineering sense, but still.)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><pre class="prettyprint lang-matlab">dydt = @(t,y) (4*t^2 - 2*y)/t;
[t,y] = ode45(dydt,[1,3],2);
plot(t,y)
xlabel('t'), ylabel('y(t)')
</pre></div>
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><img src="matlab/fo_lvc_sing.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div></article></div>
<p id="p-89">As you know, many integrals are difficult or impossible to reduce to simple fomulas, so we have to temper our expectations. Actually it's a great situation for a computer, which can apply the formulas blindly and yet do a much wider variety of integrals than we can, or do them numerically if need be.</p></section></div></main>
</div>
</body>
</html>
