<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-02-24T21:28:53-05:00    *-->
<!--*                                    *-->
<!--*   http://mathbook.pugetsound.edu   *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Other forcing functions</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script src="https://sagecell.sagemath.org/static/jquery.min.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']],
    },
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://aimath.org/mathbook/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script src="https://aimath.org/knowl.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.sticky.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.1/pretext.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/stylesheets/mathbook-3.css" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/mathbook-add-on2.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="mathbook-delaware.css">
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\newcommand{\dd}[2]{\frac{d #1}{d #2}}
\renewcommand{\Re}{\text{Re}}
\renewcommand{\Im}{\text{Im}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="notes.html"><span class="title">Notes for MATH 305</span></a></h1>
<p class="byline">Toby Driscoll</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="so-applications.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="second-order-ode.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="laplace-solutions.html" title="Next">Next</a></span></div>
<button class="sidebar-right-toggle-button button active">Annotations</button>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="so-applications.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="second-order-ode.html" title="Up">Up</a><a class="next-button button toolbar-item" href="laplace-solutions.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><h2 class="link"><a href="index.html" data-scroll="index"><span class="title">Front Matter</span></a></h2>
<ul><li><a href="preface-1.html" data-scroll="preface-1">Preface</a></li></ul>
<h2 class="link"><a href="first-order-ode.html" data-scroll="first-order-ode"><span class="codenumber">1</span> <span class="title">First-order ODEs</span></a></h2>
<ul>
<li><a href="linearity.html" data-scroll="linearity">Introduction</a></li>
<li><a href="exponentials.html" data-scroll="exponentials">Exponentials</a></li>
<li><a href="first-linear-ode.html" data-scroll="first-linear-ode">Linear ODEs</a></li>
<li><a href="first-linear-const.html" data-scroll="first-linear-const">Linear, constant-coefficients</a></li>
<li><a href="complex-exp.html" data-scroll="complex-exp">Using complex numbers</a></li>
<li><a href="variable-coeffs.html" data-scroll="variable-coeffs">Linear, variable coefficient</a></li>
<li><a href="first-order-models.html" data-scroll="first-order-models">Modeling with first-order ODEs</a></li>
<li><a href="steady-states.html" data-scroll="steady-states">Steady states</a></li>
<li><a href="logistic-equation.html" data-scroll="logistic-equation">Logistic equation</a></li>
<li><a href="separable.html" data-scroll="separable">Separable equations</a></li>
</ul>
<h2 class="link"><a href="second-order-ode.html" data-scroll="second-order-ode"><span class="codenumber">2</span> <span class="title">Second-order ODEs</span></a></h2>
<ul>
<li><a href="so-simple-harmonic.html" data-scroll="so-simple-harmonic">Simple harmonic motion</a></li>
<li><a href="so-complex-exponentials.html" data-scroll="so-complex-exponentials">Complex exponentials</a></li>
<li><a href="so-constant-coefficients.html" data-scroll="so-constant-coefficients">Constant coefficients</a></li>
<li><a href="so-forced-oscillators.html" data-scroll="so-forced-oscillators">Exponentially forced oscillators</a></li>
<li><a href="so-higher-order.html" data-scroll="so-higher-order">Higher-order ODEs</a></li>
<li><a href="so-applications.html" data-scroll="so-applications">Applications of oscillators</a></li>
<li><a href="so-general-forcing.html" data-scroll="so-general-forcing" class="active">Other forcing functions</a></li>
<li><a href="laplace-solutions.html" data-scroll="laplace-solutions">Laplace transform methods</a></li>
<li><a href="laplace-complex.html" data-scroll="laplace-complex">Complex and repeated poles</a></li>
<li><a href="laplace-properties.html" data-scroll="laplace-properties">More Laplace transforms</a></li>
<li><a href="convolutions.html" data-scroll="convolutions">Convolutions</a></li>
</ul>
<h2 class="link"><a href="qualitative.html" data-scroll="qualitative"><span class="codenumber">3</span> <span class="title">Qualitative analysis</span></a></h2>
<ul>
<li><a href="direction-fields.html" data-scroll="direction-fields">Direction fields</a></li>
<li><a href="planar-stability.html" data-scroll="planar-stability">Planar stability</a></li>
<li><a href="equilibria-linearization.html" data-scroll="equilibria-linearization">Equilibria and linearization</a></li>
</ul>
<h2 class="link"><a href="matrix-algebra.html" data-scroll="matrix-algebra"><span class="codenumber">4</span> <span class="title">Matrix algebra</span></a></h2>
<ul>
<li><a href="linear-equations.html" data-scroll="linear-equations">Linear equations</a></li>
<li><a href="elimination.html" data-scroll="elimination">Solution by elimination</a></li>
<li><a href="matrix-multiplication.html" data-scroll="matrix-multiplication">Matrix multiplication</a></li>
</ul>
<h2 class="link"><a href="linear-ode-systems.html" data-scroll="linear-ode-systems"><span class="codenumber">5</span> <span class="title">Linear ODE systems</span></a></h2>
<ul>
<li><a href="eigenvalues.html" data-scroll="eigenvalues">Eigenvalues and eigenvectors</a></li>
<li><a href="diagonalization.html" data-scroll="diagonalization">Diagonalization</a></li>
<li><a href="linear-system-solutions.html" data-scroll="linear-system-solutions">Solutions of linear ODEs</a></li>
<li><a href="matrix-exponential.html" data-scroll="matrix-exponential">The matrix exponential</a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://mathbook.pugetsound.edu">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="mathbook-content"><section class="section" id="so-general-forcing"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">2.7</span> <span class="title">Other forcing functions</span>
</h2>
<a href="so-general-forcing.html" class="permalink">¶</a><section class="introduction" id="introduction-9"><p id="p-224">Exponential forcing functions are very important, especially when allowing complex exponents. But they aren't the whole world. In this section we go over two other major techniques for trying to get particular solutions to linear, 2nd-order ODEs. Both assume that you have access to the complete null solution already.</p></section><section class="subsection" id="so-gf-muc"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.7.1</span> <span class="title">Undetermined coefficients</span>
</h3>
<a href="so-general-forcing.html#so-gf-muc" class="permalink">¶</a><p id="p-225">In the method of undetermined coefficients we assume that we already know everything about the particular solution except for some constants to be found using algebra. Best to start with examples.</p>
<article class="example-like" id="example-32"><a knowl="" class="id-ref" refid="hk-example-32"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.7.1</span>
</h6></a></article><div id="hk-example-32" class="hidden-content tex2jax_ignore"><article class="example-like"><p id="p-226">Let's find a particular solution of \(y'' +4y'+4y=8t^2\text{.}\) We reason as follows. If we plug in some \(Ct^2\) for \(y\) with a constant \(C\text{,}\) then all the derivatives generate multiples of \(t\) and \(1\text{.}\) That is, both sides of the ODE will be quadratic polynomials. So we generalize just a bit to allow</p>
<div class="displaymath">
\begin{equation*}
y_p = A + Bt + Ct^2\text{.}
\end{equation*}
</div>
<p>Plugging that into the ODE yields</p>
<div class="displaymath">
\begin{align*}
2C + 4(B+2Ct) + 4(A+Bt+Ct^2) \amp = 8t^2\\
4C t^2 + (8C+4B) + (2C+4B+4A) \apm = 8t^2\text{.}
\end{align*}
</div>
<p>This has to be an identity for all \(t\)&gt;. Matching like powers, we can read off \(C=2\text{,}\) then \(B=-4\text{,}\) and finally \(A=3\)&gt;. This provides us with \(y_p=2t^2+4t+3\text{.}\) (The complete solution would require us to use the characteristic equation to find the null solution as well.)</p></article></div>
<p id="p-227">In general, if \(f(t)\) is a polynomial, then we let \(y_p\) be a polynomial of the same degree with unknown coefficients. Substitution into the ODE and matching powers gives equations to determine those. As in the example above, you must put <em class="emphasis">all</em> the polynomial terms into \(y_p\text{,}\) even if they are missing from \(f(t)\text{.}\)</p>
<p id="p-228">The next example has a polynomial times an exponential.</p>
<article class="example-like" id="example-33"><a knowl="" class="id-ref" refid="hk-example-33"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.7.2</span>
</h6></a></article><div id="hk-example-33" class="hidden-content tex2jax_ignore"><article class="example-like"><p id="p-229">Let's try for \(y'' -2y'-3y=10te^{4t}\text{.}\) For much the same reasons as in the last case, we try</p>
<div class="displaymath">
\begin{equation*}
y_p = (A + Bt)e^{4t}\text{.}
\end{equation*}
</div>
<p>There's nothing to do now except grind out some derivatives.</p>
<div class="displaymath">
\begin{align*}
8(2A+B+2Bt)e^{4t} - 2(4A+B+4Bt)e^{4t} -3 (A + Bt)e^{4t} \amp =10t e^{4t}\\
8(2A+B) - 2(4A+B) -3A + t(16B-8B-3B) =  10t\text{.}
\end{align*}
</div>
<p>From this, by matching powers, we deduce \(B=2\) and then \(5A+12=0\text{.}\) So \(y_p = (2 - (12/5)t)e^{4t}\text{.}\)</p></article></div>
<p id="p-230">So if \(f(t)\) is a polynomial times \(e^{st}\text{,}\) let \(y_p\) be the same exponential times a polynomial of the same degree with unknown coefficients. This technically applies too if the polynomial has degree zero; this was our mainstay in <a href="so-forced-oscillators.html" class="xref" title="Section 2.4: Exponentially forced oscillators">Section 2.4</a>. It also applies for imaginary or even complex exponents.</p>
<p id="p-231">There's a method devoted to forcing by sine or cosine, multiplied by a polynomial and/or exponential. As we have seen  in previous examples, any sin or cos in the forcing requires both to be allowed in \(y_p\text{.}\) I don't personally see much value in exploring these rules, as they are no easier to use, and may be even more ornate, than the exponentials we have been doing.</p>
<p id="p-232">There is one more situation to be aware of, another variation on a familiar theme. If your \(y_p\) is part of the null solution of the ODE, you have to "promote" it by powers of \(t\) until it no longer overlaps.</p>
<article class="example-like" id="example-34"><a knowl="" class="id-ref" refid="hk-example-34"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.7.3</span>
</h6></a></article><div id="hk-example-34" class="hidden-content tex2jax_ignore"><article class="example-like"><p id="p-233">Given \(y'' -2y'-3y=4e^{-t}\text{,}\) we are led to try \(y_p=Ae^{-t}\text{:}\)</p>
<div class="displaymath">
\begin{align*}
(Ae^{-t}) - 2(-Ae^{-t}) - 3Ae^{-t} \amp = 4e^{-t} \\
0 \amp 4e^{-t} \text{.}
\end{align*}
</div>
<p>This is impossible to satisfy. What's happened is that the characteristic polynomial is \((s+1)(s-3)\text{,}\) so \(e^{-t}\) is part of the null solution (as the above calculation already showed). Instead we have to use \(y_p=Ate^{-t}\text{,}\) which gives</p>
<div class="displaymath">
\begin{align*}
Ae^{-t}(t-2) - 2Ae^{-t}(1-t) - 3Ate^{-t} \amp = 4e^{-t} \\
-4Ae^{-t} \amp 4e^{-t} \text{,}
\end{align*}
</div>
<p>so \(A=1\) and \(y_p\) is valid.</p></article></div></section><section class="subsection" id="so-gf-vp"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.7.2</span> <span class="title">Variation of parameters</span>
</h3>
<a href="so-general-forcing.html#so-gf-vp" class="permalink">¶</a><p id="p-234">While UC relies on "educated guesswork" (actually rigid rules that are a bit complex to apply), <dfn class="terminology">variation of parameters</dfn> follows the same recipe every time. Given \(L[y]=f\text{,}\) suppose we have a general null solution in the form</p>
<div class="displaymath">
\begin{equation*}
y_n(t) = c_1 y_1(t) + c_2 y_2(t)\text{.}
\end{equation*}
</div>
<p>For problems with constant coefficients, \(y_1\) and \(y_2\) are exponentials (or sin/cos equivalents), possibly multiplied by \(t\text{.}\) In any case, the VP trick is to replace the integration constants with functions of time:</p>
<div class="displaymath">
\begin{equation*}
y_p(t) = c_1(t) y_1(t) + c_2(t) y_2(t)\text{.}
\end{equation*}
</div>
<p>To keep notation simpler, we assume below that the coefficient of \(y''\) in the ODE is 1.</p>
<p id="p-235">Taking this odd assumption on faith, we compute</p>
<div class="displaymath">
\begin{equation*}
y_p' = c_1'y_1+c_1y_1'+ c_2'y_2+c_2y_2'  \text{.}
\end{equation*}
</div>
<p>Before we go on, we're going to put a restriction on our mystery functions, namely \(c_1'y_1+c_2'y_2=0\text{.}\) That makes life a little easier. Continuing, we get</p>
<div class="displaymath">
\begin{equation*}
y_p'' = c_1'y_1'+ c_1y_1'' + c_2'y_2'+ c_2y_2''  \text{.}
\end{equation*}
</div>
<p>When we put all this mess into \(y''+By'+Cy=f\text{,}\) something cool happens:</p>
<div class="displaymath">
\begin{equation*}
c_1(y_1''+By_1'+Cy_1) + c_2(y_2''+By_2'+Cy_2) + c_1'y_1' + c_2'y_2' = f \text{.}
\end{equation*}
</div>
<p>Thanks to the null property of \(y_1\) and \(y_2\text{,}\) this boils down to \(c_1'y_1' + c_2'y_2' = f\text{.}\)</p>
<p id="p-236">To summarize so far, we get a valid particular solution using two conditions,</p>
<div class="displaymath">
\begin{align*}
c_1'y_1+c_2'y_2 \amp = 0 \\
c_1'y_1' + c_2'y_2' \amp = f \text{.}
\end{align*}
</div>
<p>Stare at this long enough and you'll realize that it's just two linear equations for \(c_1'\) and \(c_2'\text{.}\) You can do some elimination to solve them, and you wind up with</p>
<div class="displaymath">
\begin{equation*}
c_1' = -\frac{y_2f}{W}, \qquad c_2' = \frac{y_1f}{W},
\end{equation*}
</div>
<p>with</p>
<div class="displaymath">
\begin{equation*}
W(t) = y_1y_2'-y_1'y_2\text{,}
\end{equation*}
</div>
<p>known as the <dfn class="terminology">Wronskian</dfn> of \(y_1\) and \(y_2\text{.}\) Finally, "all" you have to do is integrate these expressions to get \(c_1\) and \(c_2\text{,}\) and from there you get \(y_p\text{.}\)</p>
<p id="p-237">If you immediately wondered "what if the Wronskian is zero?" when you saw the above formulas, you have earned a special place in my heart. This possibility can be ruled out for some rather general theortical reasons, but we can also just calculate away the issue for equations with constant coefficients. If we have distinct characteristic roots \(s_1\) and \(s_2\text{,}\) then</p>
<div class="displaymath">
\begin{equation*}
W = (e^{s_1t})(s_2e^{s_2t}) - (s_1e^{s_1t})(e^{s_2t}) = (s_2-s_1)e^{(s_1+s_2)t}\text{.}
\end{equation*}
</div>
<p>Not zero, as promised. In the case of repeated root \(s_1\text{,}\) then</p>
<div class="displaymath">
\begin{equation*}
W = e^{s_1t}(s_1t +1)e^{s_1t} - (s_1 e^{s_1t})(t e^{s_1t}) = e^{2s_1t} \text{.}
\end{equation*}
</div>
<p>And here you were all worried.</p></section><section class="subsection" id="subsection-34"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.7.3</span> <span class="title">Fundamental solutions, again</span>
</h3>
<p id="p-238">If we continue to push ahead with the VP formulas, interesting things start to happen. For distinct roots,</p>
<div class="displaymath">
\begin{equation*}
c_1' = -\frac{\exp(s_2t)}{(s_2-s_1)\exp((s_1+s_2)t)} f(t)  =  \frac{f(t)e^{-s_1t}}{s_1-s_2}\text{,}
\end{equation*}
</div>
<p>and similarly \(c_2'= f(t)e^{-s_2t}/(s_2-s_1) \text{.}\) Then</p>
<div class="displaymath">
\begin{align*}
y_p \amp = e^{s_1 t} \int_0^t \frac{f(\tau)e^{-s_1\tau}}{s_1-s_2}\, d\tau + 
e^{s_2 t} \int_0^t \frac{f(\tau)e^{-s_2\tau}}{s_2-s_1}\, d\tau \\
\amp =  \int_0^t  f(\tau) \frac{  e^{s_1(t-\tau)} -  e^{s_2(t-\tau)}}{s_1-s_2}\, d\tau  \\
\amp =  \int_0^t  f(\tau) g(t-\tau) \, d\tau  \text{,}
\end{align*}
</div>
<p>with</p>
<div class="displaymath">
\begin{equation*}
g(t) = \frac{ e^{s_1t} -  e^{s_2t} }{s_1-s_2} \text{.}
\end{equation*}
</div>
<p>By definition the integral formula makes \(g\) an fundamental solution. Remember, \(g\) is also the impulse response, and the null solution with \(g(0)=0\text{,}\) \(g'(0)=1/A=1\text{.}\) But this derivation doesn't rely on any sketchy deltas.</p>
<p id="p-239">For the case of a repeated root we can go though the VP formulas again, or just let \(s_2\to s_1\) and get</p>
<div class="displaymath">
\begin{equation*}
g(t) = t e^{s_1t} \text{.}
\end{equation*}
</div></section></section></div></main>
</div>
</body>
</html>
