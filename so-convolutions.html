<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2020-04-25T16:26:55-04:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Convolution</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", "AMScd.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script>(function() {
  var cx = '001745383498963294448:kueq4ektvbo';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
</script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.13/pretext.js"></script><script src="https://pretextbook.org/js/0.13/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/style_default.css" rel="stylesheet" type="text/css">
<link href="colors_delaware.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/setcolors.css" rel="stylesheet" type="text/css">
<!-- 2019-10-12: Temporary - CSS file for experiments with styling --><link href="developer.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/features.css" rel="stylesheet" type="text/css">
<script>var logged_in = false;
var role = 'student';
var guest_access = true;
var login_required = false;
var js_version = 0.13;
</script>
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\newcommand{\dd}[2]{\frac{d #1}{d #2}}
\renewcommand{\Re}{\text{Re}}
\renewcommand{\Im}{\text{Im}}
\newcommand{\spr}[1]{^{(#1)}}
\newcommand{\dd}[2]{\frac{d #1}{d #2}}
\newcommand{\ddd}[2]{\frac{d^2 #1}{d #2^2}}
\newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\ppp}[2]{\frac{\partial^2 #1}{\partial #2^2}}
\newcommand{\norm}[1]{\left\| #1 \right\|}
\newcommand{\det}{\operatorname{det}}
\newcommand{\nullsp}{\operatorname{null}}
\newcommand{\spanset}{\operatorname{span}}
\newcommand{\bzero}{\boldsymbol{0}}
\newcommand{\Rn}[1]{\mathbb{R}^{#1}}
\newcommand{\Cn}[1]{\mathbb{C}^{#1}}
\newcommand{\Rmn}[2]{\mathbb{R}^{#1\times #2}}
\newcommand{\Cmn}[2]{\mathbb{C}^{#1\times #2}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\opA}{\mathcal{A}}
\newcommand{\lx}{\mathcal{L}}
\newcommand{\bA}{\mathbf{A}}
\newcommand{\bB}{\mathbf{B}}
\newcommand{\bC}{\mathbf{C}}
\newcommand{\bD}{\mathbf{D}}
\newcommand{\bI}{\mathbf{I}}
\newcommand{\bJ}{\mathbf{J}}
\newcommand{\bV}{\mathbf{V}}
\newcommand{\bX}{\mathbf{X}}
\newcommand{\bY}{\mathbf{Y}}
\newcommand{\bff}{\mathbf{f}}
\newcommand{\ba}{\mathbf{a}}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\by}{\mathbf{y}}
\newcommand{\bb}{\mathbf{b}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\bw}{\mathbf{w}}
\newcommand{\bc}{\mathbf{c}}
\newcommand{\bz}{\mathbf{z}}
\newcommand{\diag}{\operatorname{diag}}
\newcommand{\inprod}[2]{\langle #1, #2 \rangle}
\newcommand{\twovec}[2]{\begin{bmatrix}#1\\#2\end{bmatrix}}
\newcommand{\threevec}[3]{\begin{bmatrix}#1\\#2\\#3\end{bmatrix}}
\newcommand{\twodet}[4]{\begin{vmatrix}#1 \amp #2\\#3 \amp #4\end{vmatrix}}
\newcommand{\twomat}[4]{\begin{bmatrix}#1 \amp #2\\#3 \amp #4\end{bmatrix}}
\newcommand{\twodiag}[2]{\begin{bmatrix} #1 \amp 0 \\ 0 \amp #2 \end{bmatrix}}
\newcommand{\fourdiag}[3]{\begin{bmatrix} #1 \amp  \amp \amp  \\                    \amp #2 \amp  \amp  \\  \amp \amp \ddots \amp \\  \amp  \amp  \amp #3 \end{bmatrix}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="notes.html"><span class="title">Notes for MATH 305</span></a></h1>
<p class="byline">Toby Driscoll</p>
</div>
<div class="searchwrapper" role="search"><div class="gcse-search"></div></div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3">
<a class="index-button toolbar-item button" href="index-1.html" title="Index">Index</a><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="so-laplace.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="ch4-second-order-linear.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="ch5-nonlinear-ode.html" title="Next">Next</a></span>
</div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="so-laplace.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="ch4-second-order-linear.html" title="Up">Up</a><a class="next-button button toolbar-item" href="ch5-nonlinear-ode.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link">
<a href="frontmatter.html" data-scroll="frontmatter"><span class="title">Front Matter</span></a><ul><li><a href="preface-1.html" data-scroll="preface-1">Preface</a></li></ul>
</li>
<li class="link">
<a href="ch1-linear-algebra.html" data-scroll="ch1-linear-algebra"><span class="codenumber">1</span> <span class="title">Linear algebra</span></a><ul>
<li><a href="la-linear-systems.html" data-scroll="la-linear-systems">Linear systems of equations</a></li>
<li><a href="la-elimination.html" data-scroll="la-elimination">Row elimination</a></li>
<li><a href="la-vector-algebra.html" data-scroll="la-vector-algebra">Vector algebra</a></li>
<li><a href="la-matrix-algebra.html" data-scroll="la-matrix-algebra">Matrix algebra</a></li>
<li><a href="la-general-solution.html" data-scroll="la-general-solution">General and particular solutions</a></li>
<li><a href="la-basis.html" data-scroll="la-basis">Basis and dimension</a></li>
<li><a href="la-inverse.html" data-scroll="la-inverse">Inverses</a></li>
<li><a href="la-determinant.html" data-scroll="la-determinant">Determinants</a></li>
<li><a href="la-equivalent.html" data-scroll="la-equivalent">Equivalent conditions</a></li>
<li><a href="la-complex.html" data-scroll="la-complex">Complex numbers</a></li>
<li><a href="la-eigen.html" data-scroll="la-eigen">Eigenvalues</a></li>
</ul>
</li>
<li class="link">
<a href="ch2-first-order-linear.html" data-scroll="ch2-first-order-linear"><span class="codenumber">2</span> <span class="title">First-order linear ODEs</span></a><ul>
<li><a href="fl-linearity.html" data-scroll="fl-linearity">Introduction</a></li>
<li><a href="fl-linear-ode.html" data-scroll="fl-linear-ode">Linear ODEs</a></li>
<li><a href="fl-homogeneous.html" data-scroll="fl-homogeneous">Homogeneous solutions</a></li>
<li><a href="fl-varparam.html" data-scroll="fl-varparam">Variation of parameters</a></li>
<li><a href="fl-undeter.html" data-scroll="fl-undeter">Undetermined coefficients</a></li>
<li><a href="fl-models.html" data-scroll="fl-models">Modeling with first-order ODEs</a></li>
<li><a href="fl-impulse.html" data-scroll="fl-impulse">Steps and impulses</a></li>
<li><a href="fl-laplace.html" data-scroll="fl-laplace">Laplace transform methods</a></li>
</ul>
</li>
<li class="link">
<a href="ch3-first-order-systems.html" data-scroll="ch3-first-order-systems"><span class="codenumber">3</span> <span class="title">First-order linear systems</span></a><ul>
<li><a href="fs-structure.html" data-scroll="fs-structure">Structure of linear ODE systems</a></li>
<li><a href="fs-homogeneous.html" data-scroll="fs-homogeneous">Homogeneous systems</a></li>
<li><a href="fs-constcoeff.html" data-scroll="fs-constcoeff">Constant-coefficient systems</a></li>
<li><a href="fs-complex-exponentials.html" data-scroll="fs-complex-exponentials">Complex eigenvalues</a></li>
<li><a href="fs-phaseplane.html" data-scroll="fs-phaseplane">Stability in the phase plane</a></li>
<li><a href="fs-matrix-exp.html" data-scroll="fs-matrix-exp">Matrix exponential</a></li>
<li><a href="fs-varparam.html" data-scroll="fs-varparam">Variation of parameters</a></li>
</ul>
</li>
<li class="link">
<a href="ch4-second-order-linear.html" data-scroll="ch4-second-order-linear"><span class="codenumber">4</span> <span class="title">Second-order ODEs</span></a><ul>
<li><a href="so-convert.html" data-scroll="so-convert">Order equals dimension</a></li>
<li><a href="so-homogeneous.html" data-scroll="so-homogeneous">Homogeneous problem</a></li>
<li><a href="so-undetermined.html" data-scroll="so-undetermined">Undetermined coefficients</a></li>
<li><a href="so-oscillators.html" data-scroll="so-oscillators">Oscillators</a></li>
<li><a href="so-expforcing.html" data-scroll="so-expforcing">Driven oscillator</a></li>
<li><a href="so-laplace.html" data-scroll="so-laplace">Laplace transform methods</a></li>
<li><a href="so-convolutions.html" data-scroll="so-convolutions" class="active">Convolution</a></li>
</ul>
</li>
<li class="link">
<a href="ch5-nonlinear-ode.html" data-scroll="ch5-nonlinear-ode"><span class="codenumber">5</span> <span class="title">Nonlinear ODEs</span></a><ul>
<li><a href="nl-autonomous.html" data-scroll="nl-autonomous">Autonomous scalar problems</a></li>
<li><a href="nl-separable.html" data-scroll="nl-separable">Separable equations</a></li>
<li><a href="nl-logistic.html" data-scroll="nl-logistic">Case study: Logistic equation</a></li>
<li><a href="nl-directionfields.html" data-scroll="nl-directionfields">Direction fields</a></li>
<li><a href="nl-linearization.html" data-scroll="nl-linearization">Linearization</a></li>
</ul>
</li>
<li class="link"><a href="backmatter-1.html" data-scroll="backmatter-1"><span class="title">Back Matter</span></a></li>
<li class="link"><a href="appendix-1.html" data-scroll="appendix-1"><span class="codenumber">A</span> <span class="title">Notation glossary</span></a></li>
<li class="link"><a href="index-1.html" data-scroll="index-1"><span class="title">Index</span></a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="so-convolutions"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">4.7</span> <span class="title">Convolution</span>
</h2>
<a href="so-convolutions.html" class="permalink">¶</a><section class="introduction" id="introduction-20"><p id="p-527"></p></section><section class="subsection" id="subsection-52"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">4.7.1</span> <span class="title">Moving averages</span>
</h3>
<p id="p-528">The following grabs and plots the closing price of Bitcoin for the last 31 days.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><figure class="listing figure-like" id="so_conv_bitcoin1"><pre class="prettyprint lang-matlab">load bitcoindata
v = struct2cell(data.bpi);
v = cat(1,v{:});
plot(v,'-o')
</pre>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">4.7.1<span class="period">.</span></span><span class="space"> </span>Raw bitcoin price data</figcaption></figure></div>
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><img src="figures/so_conv_bitcoin1.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div>
<p id="p-529">It's a noisy curve. We can smooth that out by taking 4-day moving averages, for example. I don't claim that this is the best way, but we can do this by:</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><figure class="listing figure-like" id="so_conv_bitcoin2"><pre class="prettyprint lang-matlab">load bitcoindata
v = struct2cell(data.bpi);
v = cat(1,v{:});
plot(v,'-ko')
for i = 4:31
    z(i) = (v(i)+v(i-1)+v(i-2)+v(i-3))/4;
end
z(1:3) = NaN;  % not a number
hold on, plot(z,'-o')
</pre>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">4.7.2<span class="period">.</span></span><span class="space"> </span>Data with 4-day moving average</figcaption></figure></div>
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><img src="figures/so_conv_bitcoin2.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div>
<p id="p-530">We might decide, however, to weight the most recent values more heavily. Here's how this might look.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><figure class="listing figure-like" id="so_conv_bitcoin3"><pre class="prettyprint lang-matlab">load bitcoindata
v = struct2cell(data.bpi);
v = cat(1,v{:});
plot(v,'-ko')
w = [4 3 2 1];
for i = 4:31
	z(i) = (w(1)*v(i) + w(2)*v(i-1)... 
	  + w(3)*v(i-2) + w(4)*v(i-3)) / sum(w);
end
z(1:3) = NaN;  % not a number
hold on, plot(z,'-o')
</pre>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">4.7.3<span class="period">.</span></span><span class="space"> </span>Data with weighted moving average</figcaption></figure></div>
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><img src="figures/so_conv_bitcoin3.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div>
<p id="p-531">Note that each new value \(z_i\) is a linear combination of the elements of \(v\text{,}\) weighted by the values in \(w\text{.}\) And we always go forward 1,2,3,4 in \(w\text{,}\) while on \(v\) we have a sliding group going backward: \(i,i-1,i-2,i-3\text{.}\) Put concisely, the indices add up to the constant value \(i+1\text{.}\)</p></section><section class="subsection" id="subsection-53"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">4.7.2</span> <span class="title">Convolution integral</span>
</h3>
<p id="p-532">The moving average above gave us a certain way to multiply together vectors \(v\) and \(w\) to get a new vector \(z\text{:}\)</p>
<div class="displaymath">
\begin{equation*}
z_i =  \sum_{j} w_j v_{i-j} 
\end{equation*}
</div>
<p data-braille="continuation">(although I reindexed the output vector from \(i+1\) to \(i\) compared to the computer code). This is analogous to a different way to multiply two <em class="emphasis">functions</em>, by the <dfn class="terminology">convolution integral</dfn></p>
<div class="displaymath">
\begin{equation*}
[f*g](t) = \int_0^t f(t-\tau)g(\tau)\, d\tau\text{.}
\end{equation*}
</div>
<p data-braille="continuation">This too is like a weighted average, with the values of \(g(\tau)\) being multiplied against different windows of the function \(f\) such that the arguments sum to \(t\text{.}\)</p>
<p id="p-533">An interesting fact is that while I interpreted \(f*g\) as \(g\) acting on \(f\text{,}\) in fact the operation is commutative:</p>
<div class="displaymath">
\begin{align*}
[g*f](t) \amp = \int_0^t f(t-\tau)g(\tau)\, d\tau\\
\amp = \int_t^0 f(u)g(t-u)\, (-du)  \\
\amp = \int_0^t g(t-u)f(u)\, du = [f*g](t)\text{.}
\end{align*}
</div>
<p data-braille="continuation">There are several other properties that make convolution resemble multiplication.</p>
<article class="fact theorem-like" id="so-fact-convolution"><h6 class="heading">
<span class="type">Fact</span><span class="space"> </span><span class="codenumber">4.7.4</span><span class="period">.</span>
</h6>
<p id="p-534">The following statements are true for functions defined for \(t\ge 0\text{.}\)</p>
<ol class="decimal">
<li id="li-68">\(\displaystyle f*g = g*f\)</li>
<li id="li-69">\(\displaystyle (f*g)*h = f*(g*h)\)</li>
<li id="li-70">\(\displaystyle f*(g+h) = (f*g) + (f*h)\)</li>
<li id="li-71">\(f*0=0\quad\) (zero function)</li>
<li id="li-72">\(\displaystyle f*\delta = f\)</li>
</ol></article><p id="p-535">The last of these facts is the only slight curveball. It says that the delta impulse serves as the identity in convolution operations.</p></section><section class="subsection" id="subsection-54"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">4.7.3</span> <span class="title">Transfer function and impulse response</span>
</h3>
<p id="p-536">Following what we did for first-order problems, we make the following definitions.</p>
<article class="definition definition-like" id="s0-def-impulsetransfer"><h6 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">4.7.5</span><span class="period">.</span>
</h6>
<p id="p-537">For the operator \(\opA[x]=x'' + bx'+cx\) with constant coefficients, we define the <dfn class="terminology">impulse response</dfn> as the solution of</p>
<div class="displaymath">
\begin{equation*}
\opA[x] = \delta(t), \quad x(0)=x'(0)=0.
\end{equation*}
</div>
<p data-braille="continuation">We will use \(g(t)\) to denote the impulse response. We also define the <dfn class="terminology">transfer function</dfn> of the ODE to be the transform \(G(s)\) of the impulse response.</p></article><p id="p-538">Because the transform of delta is one, the immediate consequence of combining these definitions is</p>
<div class="displaymath">
\begin{equation*}
s^2 G + bs G + cG  = 1 \quad\Rightarrow\quad G(s) = \frac{1}{s^2+bs+c}.
\end{equation*}
</div>
<p data-braille="continuation">In words, <em class="alert">the transfer function is the recciprocal of the characteristic polynomial.</em></p>
<article class="example example-like" id="example-83"><a data-knowl="" class="id-ref original" data-refid="hk-example-83"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">4.7.6</span><span class="period">.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-83"><article class="example example-like"><p id="p-539">The transform of \(x''-5x'+4x=\delta(t)\) with zero initial conditions leads to</p>
<div class="displaymath">
\begin{equation*}
X(s) = G(s) = \frac{1}{s^2+5s+4} = \frac{A}{s+1} + \frac{B}{s+4}. 
\end{equation*}
</div>
<p data-braille="continuation">Clearing denominators and setting \(s\) equal to each pole in turn gives \(A=-B=1/3\text{,}\) so the impulse response is</p>
<div class="displaymath">
\begin{equation*}
g(t) = \frac{1}{3}(e^{-t}-e^{-4t}).
\end{equation*}
</div></article></div>
<p id="p-540">It is trivial to generalize the previous example to any distinct eigenvalues \(\lambda_1,\lambda_2\text{:}\)</p>
<div class="displaymath">
\begin{equation*}
g(t) = \frac{1}{\lambda_1-\lambda_2}\bigl(e^{\lambda_1 t}-e^{\lambda_2 t}\bigr). 
\end{equation*}
</div>
<p data-braille="continuation">Since it's a linear combination of the homogeneous exponential solutions, \(g(t)\) is equivalent to the solution of a homogeneous problem. You can easily check that \(g(0)=0\) and \(g'(0)=1\text{.}\) Hence:</p>
<article class="fact theorem-like" id="so-fact-jump"><h6 class="heading">
<span class="type">Fact</span><span class="space"> </span><span class="codenumber">4.7.7</span><span class="period">.</span>
</h6>
<p id="p-541">In second order problems, an impulse is equivalent to an instantaneous jump in the derivative of the solution.</p></article><p id="p-542">This fact modifies the observation in first-order problems that the delta causes a jump in <em class="emphasis">value</em>.</p></section><section class="subsection" id="subsection-55"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">4.7.4</span> <span class="title">Convolution theorem</span>
</h3>
<p id="p-543">Here is what makes convolution a really big deal.</p>
<article class="theorem theorem-like" id="theorem-13"><h6 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">4.7.8</span><span class="period">.</span>
</h6>
<p id="p-544">Suppose \(\lx[f] = F(s)\text{,}\) \(\lx[g] = G(s)\text{,}\) \(x=f*g\text{,}\) and \(\lx[x] = X(s)\text{.}\) Then \(X(s)=F(s)G(s)\text{.}\)</p></article><p id="p-545">Why does this matter? Consider finding a particular solution of \(x''+bx'+cx=f(t)\) with zero initial conditions. After taking transforms we get</p>
<div class="displaymath">
\begin{equation*}
X_p(s) = \frac{1}{s^2+bs+c} F(s) = G(s) F(s)\text{,}
\end{equation*}
</div>
<p data-braille="continuation">where \(G(s)\) is the transfer function. Right away then, we know that \(x_p(t)=f(t)*g(t)\) is that particular solution. In theory, knowing the impulse response is enough to write down the solution of any forced problem.</p>
<article class="example example-like" id="example-84"><a data-knowl="" class="id-ref original" data-refid="hk-example-84"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">4.7.9</span><span class="period">.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-84"><article class="example example-like"><p id="p-546">Above we found the impulse response of \(x''-5x'+4x\) to be \(g(t)=\frac{1}{3}=(e^{-t}-e^{-4t})\text{.}\) Hence a particular solution for forcing function \(f\) is</p>
<div class="displaymath">
\begin{align*}
x_p(t) \amp = f*g = \frac{1}{3} \int_0^t ( e^{-t+\tau}-e^{-4t+4\tau})\, f(\tau)\,d\tau \\
\amp = \frac{1}{3} e^{-t} \int_0^t e^{\tau}  f(\tau)\,d\tau -  \frac{1}{3} e^{-4t} \int_0^t  e^{4\tau} f(\tau)\,d\tau. 
\end{align*}
</div></article></div>
<article class="example example-like" id="example-85"><a data-knowl="" class="id-ref original" data-refid="hk-example-85"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">4.7.10</span><span class="period">.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-85"><article class="example example-like"><p id="p-547">The undamped oscillator \(x''+\omega_0^2 x\) has transfer function</p>
<div class="displaymath">
\begin{equation*}
G(s) = \frac{1}{s^2+\omega_0^2}\text{,}
\end{equation*}
</div>
<p data-braille="continuation">so \(g(t) = \frac{1}{\omega_0}\sin(\omega_0 t)\text{.}\) Note that</p>
<div class="displaymath">
\begin{equation*}
g(t-\tau) = \frac{1}{\omega_0} \sin(\omega_0 t)\cos(\omega_0\tau) - \frac{1}{\omega_0} \cos(\omega_0 t)\sin(\omega_0\tau). 
\end{equation*}
</div>
<p data-braille="continuation">Therefore, using convolution with forcing function \(f\text{,}\)</p>
<div class="displaymath">
\begin{equation*}
x_p(t) = \frac{1}{\omega_0}  \sin(\omega_0 t) \int_0^t \cos(\omega_0\tau)f(\tau)\,d\tau - \frac{1}{\omega_0}  \cos(\omega_0 t) \int_0^t \sin(\omega_0\tau)f(\tau)\,d\tau.
\end{equation*}
</div>
<p data-braille="continuation">This formula would be another way to derive both the resonant and nonresonant solutions with cosine forcing \(f(t)=\cos(\omega t)\text{.}\)</p></article></div>
<p id="p-548">By now it should not surprise you that linear problems give you multiple options that converge on the same results. The integral formulas derived from convolution with the impulse response are identical to ones that we would derive by applying variation of parameters to the first-order system form of the ODE. Both examples above express the solution as functions times the homogeneous solutions of the system, which is the starting assumption for deriving that method.</p></section><section class="exercises" id="so-exer-convolution"><h3 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber">4.7.5</span> <span class="title">Exercises</span>
</h3>
<a href="so-convolutions.html#so-exer-convolution" class="permalink">¶</a><article class="exercise exercise-like" id="exercise-23"><h6 class="heading">
<span class="codenumber">1<span class="period">.</span></span><span class="space"> </span><span class="title">Double eigenvalue.</span>
</h6>
<p id="p-549">In the impulse response for distinct eigenvalues, take the limit \(\lambda_2 \to \lambda_1\) to propose an impulse response \(g(t)\) for the case of a double eigenvalue. Then show that \(g\) solves the homogeneous problem, and \(g(0)=0\text{,}\) \(g'(0)=1\text{.}\) Finally, show that the transform of \(g\) does match the transfer function.</p></article><article class="exercise exercise-like" id="exercise-24"><h6 class="heading">
<span class="codenumber">2<span class="period">.</span></span><span class="space"> </span><span class="title">Damped oscillator.</span>
</h6>
<p id="p-551">Use convolution to derive the solution of the damped oscillator \(x''+2\omega_0 Z x' + \omega_0^2 x = f(t)\text{.}\) Express the formulas in real form in the underdamped case.</p></article></section><section class="solutions" id="solutions-8"><h3 class="heading hide-type">
<span class="type">Solutions</span> <span class="codenumber">4.7.6</span> <span class="title">Solutions</span>
</h3>
<section class="exercises"><h4 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber">4.7.5</span> <span class="title">Exercises</span>
</h4>
<a href="so-convolutions.html#so-exer-convolution" class="permalink">¶</a><article class="exercise-like"><h6 class="heading">
<span class="codenumber">4.7.5.1<span class="period">.</span></span><span class="space"> </span><span class="title">Double eigenvalue.</span>
</h6>
<div class="solutions"><a class="original" data-knowl="./knowl/solution-18-hidden.html" title="Solution 4.7.5.1.1"><span class="type">Solution</span></a></div></article></section></section></section></div></main>
</div>
<div class="login-link"><span id="loginlogout" class="login">login</span></div>
<script src="https://pretextbook.org/js/0.13/login.js"></script>
</body>
</html>
