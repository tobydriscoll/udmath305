<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-04-10T11:21:39-04:00    *-->
<!--*                                    *-->
<!--*   http://mathbook.pugetsound.edu   *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Convolutions</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script src="https://sagecell.sagemath.org/static/jquery.min.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']],
    },
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://aimath.org/mathbook/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script src="https://aimath.org/knowl.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.sticky.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.1/pretext.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/stylesheets/mathbook-3.css" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/mathbook-add-on2.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="mathbook-delaware.css">
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(  \newcommand{\dd}[2]{\frac{d #1}{d #2}}
  \renewcommand{\Re}{\text{Re}}
  \renewcommand{\Im}{\text{Im}}
  \newcommand{\Span}[1]{\langle#1\rangle}
  \newcommand{\spr}[1]{^{(#1)}}
  \newcommand{\dd}[2]{\frac{d #1}{d #2}}
  \newcommand{\ddd}[2]{\frac{d^2 #1}{d #2^2}}
  \newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
  \newcommand{\norm}[1]{\left\| #1 \right\|}
  \newcommand{\det}{\operatorname{det}}
  \newcommand{\bzero}{\boldsymbol{0}}
  \newcommand{\bu}{\mathbf{u}}
  \newcommand{\bA}{\mathbf{A}}
  \newcommand{\bB}{\mathbf{B}}
  \newcommand{\bC}{\mathbf{C}}
 \newcommand{\bD}{\mathbf{D}}
  \newcommand{\bI}{\mathbf{I}}
  \newcommand{\bV}{\mathbf{V}}
\newcommand{\bff}{\mathbf{f}}
  \newcommand{\bx}{\mathbf{x}}
  \newcommand{\by}{\mathbf{y}}
  \newcommand{\bb}{\mathbf{b}}
  \newcommand{\bu}{\mathbf{u}}
  \newcommand{\bv}{\mathbf{v}}
  \newcommand{\bw}{\mathbf{w}}
  \newcommand{\bc}{\mathbf{c}}
  \newcommand{\bz}{\mathbf{z}}
  \newcommand{\twovec}[2]{\begin{bmatrix}#1\\#2\end{bmatrix}}
  \newcommand{\twodet}[4]{\begin{vmatrix}#1 \amp #2\\#3 \amp #4\end{vmatrix}}
  \newcommand{\twomat}[4]{\begin{bmatrix}#1 \amp #2\\#3 \amp #4\end{bmatrix}}
  \newcommand{\twodiag}[2]{\begin{bmatrix} #1 \amp 0 \\ 0 \amp #2 \end{bmatrix}}
  \newcommand{\fourdiag}[3]{\begin{bmatrix} #1 \amp  \amp \amp  \\                    \amp #2 \amp  \amp  \\  \amp \amp \ddots \amp \\  \amp  \amp  \amp #3 \end{bmatrix}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="notes.html"><span class="title">Notes for MATH 305</span></a></h1>
<p class="byline">Toby Driscoll</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="so-laplace-repeated.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="second-order-ode.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="two-dimensional-systems.html" title="Next">Next</a></span></div>
<button class="sidebar-right-toggle-button button active">Annotations</button>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="so-laplace-repeated.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="second-order-ode.html" title="Up">Up</a><a class="next-button button toolbar-item" href="two-dimensional-systems.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><h2 class="link"><a href="index.html" data-scroll="index"><span class="title">Front Matter</span></a></h2>
<ul><li><a href="preface-1.html" data-scroll="preface-1">Preface</a></li></ul>
<h2 class="link"><a href="first-order-ode.html" data-scroll="first-order-ode"><span class="codenumber">1</span> <span class="title">First-order ODEs</span></a></h2>
<ul>
<li><a href="linearity.html" data-scroll="linearity">Introduction</a></li>
<li><a href="exponentials.html" data-scroll="exponentials">Exponentials</a></li>
<li><a href="first-linear-ode.html" data-scroll="first-linear-ode">Linear ODEs</a></li>
<li><a href="first-linear-const.html" data-scroll="first-linear-const">Linear, constant-coefficients</a></li>
<li><a href="complex-exp.html" data-scroll="complex-exp">Using complex numbers</a></li>
<li><a href="variable-coeffs.html" data-scroll="variable-coeffs">Linear, variable coefficient</a></li>
<li><a href="first-order-models.html" data-scroll="first-order-models">Modeling with first-order ODEs</a></li>
<li><a href="steady-states.html" data-scroll="steady-states">Steady states</a></li>
<li><a href="logistic-equation.html" data-scroll="logistic-equation">Logistic equation</a></li>
<li><a href="separable.html" data-scroll="separable">Separable equations</a></li>
<li><a href="laplace-solutions.html" data-scroll="laplace-solutions">Laplace transform methods</a></li>
</ul>
<h2 class="link"><a href="second-order-ode.html" data-scroll="second-order-ode"><span class="codenumber">2</span> <span class="title">Second-order ODEs</span></a></h2>
<ul>
<li><a href="so-simple-harmonic.html" data-scroll="so-simple-harmonic">Simple harmonic motion</a></li>
<li><a href="so-complex-exponentials.html" data-scroll="so-complex-exponentials">Complex exponentials</a></li>
<li><a href="so-constant-coefficients.html" data-scroll="so-constant-coefficients">Constant coefficients</a></li>
<li><a href="so-forced-oscillators.html" data-scroll="so-forced-oscillators">Exponentially forced oscillators</a></li>
<li><a href="so-higher-order.html" data-scroll="so-higher-order">Higher-order ODEs</a></li>
<li><a href="so-applications.html" data-scroll="so-applications">Applications of oscillators</a></li>
<li><a href="so-general-forcing.html" data-scroll="so-general-forcing">Other forcing functions</a></li>
<li><a href="so-laplace.html" data-scroll="so-laplace">Laplace transform methods</a></li>
<li><a href="so-laplace-repeated.html" data-scroll="so-laplace-repeated">Repeated and complex poles</a></li>
<li><a href="so-convolutions.html" data-scroll="so-convolutions" class="active">Convolutions</a></li>
</ul>
<h2 class="link"><a href="two-dimensional-systems.html" data-scroll="two-dimensional-systems"><span class="codenumber">3</span> <span class="title">2D systems</span></a></h2>
<ul>
<li><a href="twod-slope-fields.html" data-scroll="twod-slope-fields">Slope fields</a></li>
<li><a href="twod-fixed-points.html" data-scroll="twod-fixed-points">Linear 2D systems</a></li>
<li><a href="twod-linearization.html" data-scroll="twod-linearization">Linearization</a></li>
</ul>
<h2 class="link"><a href="matrix-algebra.html" data-scroll="matrix-algebra"><span class="codenumber">4</span> <span class="title">Matrix algebra</span></a></h2>
<ul>
<li><a href="ma-rows-columns.html" data-scroll="ma-rows-columns">Rows and columns</a></li>
<li><a href="ma-elimination.html" data-scroll="ma-elimination">Elimination for linear systems</a></li>
<li><a href="ma-multiplication.html" data-scroll="ma-multiplication">Multiplying matrices and vectors</a></li>
<li><a href="ma-inverses.html" data-scroll="ma-inverses">Matrix inverses</a></li>
<li><a href="section-29.html" data-scroll="section-29">Eigenvalues</a></li>
<li><a href="section-30.html" data-scroll="section-30">Diagonalization</a></li>
<li><a href="section-31.html" data-scroll="section-31">Linear ODE systems</a></li>
<li><a href="section-32.html" data-scroll="section-32">Matrix exponential</a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://mathbook.pugetsound.edu">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="mathbook-content"><section class="section" id="so-convolutions"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">2.10</span> <span class="title">Convolutions</span>
</h2>
<a href="so-convolutions.html" class="permalink">¶</a><section class="introduction" id="introduction-12"><p id="p-274"><em class="emphasis">From section 8.6, pp. 479–483 (skip Fourier and matrix material)</em></p></section><section class="subsection" id="subsection-41"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.10.1</span> <span class="title">Moving averages</span>
</h3>
<p id="p-275">The following grabs and plots the closing price of Bitcoin for the last 31 days.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><pre class="prettyprint lang-matlab">%bc = webread('https://api.coindesk.com/v1/bpi/historical/close.json');
%data = jsondecode(bc);
load bitcoindata
v = struct2cell(data.bpi);
v = cat(1,v{:});
plot(v,'-o')
</pre></div>
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><img src="matlab/so_conv_bitcoin1.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div>
<p id="p-276">It's a noisy curve. We can smooth that out by taking 4-day moving averages, for example. I don't claim that this is the best way, but we can do this by:</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><pre class="prettyprint lang-matlab">%bc = webread('https://api.coindesk.com/v1/bpi/historical/close.json');
%data = jsondecode(bc);
load bitcoindata
v = struct2cell(data.bpi);
v = cat(1,v{:});
plot(v,'-ko')
for i = 4:31
    z(i) = (v(i) + v(i-1) + v(i-2) + v(i-3)) / 4;
end
z(1:3) = NaN;  % not a number
hold on, plot(z,'-o')
</pre></div>
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><img src="matlab/so_conv_bitcoin2.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div>
<p id="p-277">We might decide, however, to weight the most recent values more heavily. Here's how this might look.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><pre class="prettyprint lang-matlab">%bc = webread('https://api.coindesk.com/v1/bpi/historical/close.json');
%data = jsondecode(bc);
load bitcoindata
v = struct2cell(data.bpi);
v = cat(1,v{:});
plot(v,'-ko')
w = [4 3 2 1];
for i = 4:31
    z(i) = (w(1)*v(i) + w(2)*v(i-1) + w(3)*v(i-2) + w(4)*v(i-3)) / sum(w);
end
z(1:3) = NaN;  % not a number
hold on, plot(z,'-o')
</pre></div>
<div class="sbspanel" style="width:50%;justify-content:flex-start;"><img src="matlab/so_conv_bitcoin3.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div>
<p id="p-278">Note that each new value \(z_i\) is a linear combination of the elements of \(v\text{,}\) weighted by the values in \(w\text{.}\) And we always go forward 1,2,3,4 in \(w\text{,}\) while on \(v\) we have a sliding group going backward: \(i,i-1,i-2,i-3\text{.}\) Put concisely, the indices add up to the constant value \(i+1\text{.}\)</p></section><section class="subsection" id="subsection-42"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.10.2</span> <span class="title">Convolution integral</span>
</h3>
<p id="p-279">The moving average above gave us a certain way to multiply together vectors \(v\) and \(w\) to get a new vector \(z\text{:}\)</p>
<div class="displaymath">
\begin{equation*}
z_i =  \sum_{j} w_j v_{i-j} 
\end{equation*}
</div>
<p>(although I reindexed the output vector from \(i+1\) to \(i\) compared to the computer code). This is analogous to a different way to multiply two <em class="emphasis">functions</em>, by the <dfn class="terminology">convolution integral</dfn></p>
<div class="displaymath">
\begin{equation*}
[f*g](t) = \int_0^t f(t-\tau)g(\tau)\, d\tau\text{.}
\end{equation*}
</div>
<p>This too is like a weighted average, with the values of \(g(\tau)\) being multiplied against different windows of the function \(f\) such that the arguments sum to \(t\text{.}\)</p>
<p id="p-280">An interesting fact is that while I interpreted \(f*g\) as \(g\) acting on \(f\text{,}\) in fact the operation is symmetric:</p>
<div class="displaymath">
\begin{align*}
[g*f](t) \amp = \int_0^t f(t-\tau)g(\tau)\, d\tau\\
\amp = \int_t^0 f(u)g(t-u)\, (-du)  \\
\amp = \int_0^t g(t-u)f(u)\, du = [f*g](t)\text{.}
\end{align*}
</div>
<p>We can also easily prove some more properties we really like to have:</p>
<div class="displaymath">
\begin{gather*}
f * ( g * h ) = ( f * g) * h \\
f * (g+h)=(f * g)+(f*h)\\
f * 0=0\text{.}
\end{gather*}
</div>
<p>It is <em class="emphasis">not</em> true, however, that \(f*1=f\text{,}\) unless \(f\) is the zero function. Instead, the right formula is \(f * \delta=f\text{:}\)</p>
<div class="displaymath">
\begin{equation*}
[f*\delta](t) = \int_0^t f(t-\tau) \delta(\tau)\, d\tau = f(t)\text{.}
\end{equation*}
</div></section><section class="subsection" id="subsection-43"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.10.3</span> <span class="title">Convolution theorem</span>
</h3>
<p id="p-281">Here is what makes convolution a pretty big deal.</p>
<article class="theorem-like" id="theorem-1"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.10.1</span>
</h6>
<p id="p-282">Suppose \({\cal L}[f] = F(s)\text{,}\) \({\cal L}[g] = G(s)\text{,}\) \(h=f*g\text{,}\) and \({\cal L}[h] = H(s)\text{.}\) Then \(H(s)=F(s)G(s)\text{.}\)</p></article><p id="p-283">Why does this matter? Consider finding a particular solution of \(Ay''+By'+Cy=f(t)\text{.}\) After taking transforms we get</p>
<div class="displaymath">
\begin{equation*}
Y(s) = \frac{1}{As^2+Bs+C} F(s) = G(s) F(s)\text{,}
\end{equation*}
</div>
<p>where \(G(s)\) is our old friend the transfer function. Right away then, we know that \(y(t)=f(t)*g(t)\text{.}\)</p>
<p id="p-284">Wait, there's more! Consider the problem of the impulse response, \(Ay''+By'+Cy=\delta(t)\text{,}\) with zero initial conditions. The solution of this problem has \(Y(s)=G(s)\text{.}\) That is,</p>
<article class="theorem-like" id="fact-2"><h6 class="heading">
<span class="type">Fact</span> <span class="codenumber">2.10.2</span>
</h6>
<p id="p-285">The impulse response of a linear constant-coefficient equation is the inverse Laplace transform of the transfer function.</p></article><p id="p-286">Put it all together and you see that the solution to any forced problem is a convolution of the forcing with the impulse response/fundamental solution, whose transform is the transfer function. Which is the reciprocal of the characteristic polynomial! Evaluating convolution integrals for specific functions is rarely easy, so the most important implications here are theoretical.</p></section></section></div></main>
</div>
</body>
</html>
