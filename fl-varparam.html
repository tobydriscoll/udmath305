<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2020-02-20T08:47:41-05:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Variation of parameters</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", "AMScd.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script>(function() {
  var cx = '001745383498963294448:kueq4ektvbo';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
</script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.13/pretext.js"></script><script src="https://pretextbook.org/js/0.13/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/style_default.css" rel="stylesheet" type="text/css">
<link href="colors_delaware.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/setcolors.css" rel="stylesheet" type="text/css">
<!-- 2019-10-12: Temporary - CSS file for experiments with styling --><link href="developer.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/features.css" rel="stylesheet" type="text/css">
<script>var logged_in = false;
var role = 'student';
var guest_access = true;
var login_required = false;
var js_version = 0.13;
</script>
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\newcommand{\dd}[2]{\frac{d #1}{d #2}}
\renewcommand{\Re}{\text{Re}}
\renewcommand{\Im}{\text{Im}}
\newcommand{\spr}[1]{^{(#1)}}
\newcommand{\dd}[2]{\frac{d #1}{d #2}}
\newcommand{\ddd}[2]{\frac{d^2 #1}{d #2^2}}
\newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\ppp}[2]{\frac{\partial^2 #1}{\partial #2^2}}
\newcommand{\norm}[1]{\left\| #1 \right\|}
\newcommand{\det}{\operatorname{det}}
\newcommand{\null}{\operatorname{null}}
\newcommand{\span}{\operatorname{span}}
\newcommand{\bzero}{\boldsymbol{0}}
\newcommand{\Rn}[1]{\mathbb{R}^{#1}}
\newcommand{\Cn}[1]{\mathbb{C}^{#1}}
\newcommand{\Rmn}[2]{\mathbb{R}^{#1\times #2}}
\newcommand{\Cmn}[2]{\mathbb{C}^{#1\times #2}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\opA}{\mathcal{A}}
\newcommand{\lx}{\mathcal{L}}
\newcommand{\bA}{\mathbf{A}}
\newcommand{\bB}{\mathbf{B}}
\newcommand{\bC}{\mathbf{C}}
\newcommand{\bD}{\mathbf{D}}
\newcommand{\bI}{\mathbf{I}}
\newcommand{\bJ}{\mathbf{J}}
\newcommand{\bV}{\mathbf{V}}
\newcommand{\bX}{\mathbf{X}}
\newcommand{\bY}{\mathbf{Y}}
\newcommand{\bff}{\mathbf{f}}
\newcommand{\ba}{\mathbf{a}}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\by}{\mathbf{y}}
\newcommand{\bb}{\mathbf{b}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\bw}{\mathbf{w}}
\newcommand{\bc}{\mathbf{c}}
\newcommand{\bz}{\mathbf{z}}
\newcommand{\inprod}[2]{\langle #1, #2 \rangle}
\newcommand{\twovec}[2]{\begin{bmatrix}#1\\#2\end{bmatrix}}
\newcommand{\threevec}[3]{\begin{bmatrix}#1\\#2\\#3\end{bmatrix}}
\newcommand{\twodet}[4]{\begin{vmatrix}#1 \amp #2\\#3 \amp #4\end{vmatrix}}
\newcommand{\twomat}[4]{\begin{bmatrix}#1 \amp #2\\#3 \amp #4\end{bmatrix}}
\newcommand{\twodiag}[2]{\begin{bmatrix} #1 \amp 0 \\ 0 \amp #2 \end{bmatrix}}
\newcommand{\fourdiag}[3]{\begin{bmatrix} #1 \amp  \amp \amp  \\                    \amp #2 \amp  \amp  \\  \amp \amp \ddots \amp \\  \amp  \amp  \amp #3 \end{bmatrix}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="notes.html"><span class="title">Notes for MATH 305</span></a></h1>
<p class="byline">Toby Driscoll</p>
</div>
<div class="searchwrapper" role="search"><div class="gcse-search"></div></div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3">
<a class="index-button toolbar-item button" href="index-1.html" title="Index">Index</a><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="fl-homogeneous.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="ch2-first-order-linear.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="fl-undeter.html" title="Next">Next</a></span>
</div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="fl-homogeneous.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="ch2-first-order-linear.html" title="Up">Up</a><a class="next-button button toolbar-item" href="fl-undeter.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link">
<a href="frontmatter.html" data-scroll="frontmatter"><span class="title">Front Matter</span></a><ul><li><a href="preface-1.html" data-scroll="preface-1">Preface</a></li></ul>
</li>
<li class="link">
<a href="ch1-linear-algebra.html" data-scroll="ch1-linear-algebra"><span class="codenumber">1</span> <span class="title">Linear algebra</span></a><ul>
<li><a href="la-linear-systems.html" data-scroll="la-linear-systems">Linear systems of equations</a></li>
<li><a href="la-elimination.html" data-scroll="la-elimination">Row elimination</a></li>
<li><a href="la-vector-algebra.html" data-scroll="la-vector-algebra">Vector algebra</a></li>
<li><a href="la-matrix-algebra.html" data-scroll="la-matrix-algebra">Matrix algebra</a></li>
<li><a href="la-general-solution.html" data-scroll="la-general-solution">General and particular solutions</a></li>
<li><a href="la-basis.html" data-scroll="la-basis">Basis and dimension</a></li>
<li><a href="la-inverse.html" data-scroll="la-inverse">Inverses</a></li>
<li><a href="la-determinant.html" data-scroll="la-determinant">Determinants</a></li>
<li><a href="la-equivalent.html" data-scroll="la-equivalent">Equivalent conditions</a></li>
<li><a href="la-complex.html" data-scroll="la-complex">Complex numbers</a></li>
<li><a href="la-eigen.html" data-scroll="la-eigen">Eigenvalues</a></li>
</ul>
</li>
<li class="link">
<a href="ch2-first-order-linear.html" data-scroll="ch2-first-order-linear"><span class="codenumber">2</span> <span class="title">First-order linear ODEs</span></a><ul>
<li><a href="fl-linearity.html" data-scroll="fl-linearity">Introduction</a></li>
<li><a href="fl-linear-ode.html" data-scroll="fl-linear-ode">Linear ODEs</a></li>
<li><a href="fl-homogeneous.html" data-scroll="fl-homogeneous">Homogeneous solutions</a></li>
<li><a href="fl-varparam.html" data-scroll="fl-varparam" class="active">Variation of parameters</a></li>
<li><a href="fl-undeter.html" data-scroll="fl-undeter">Undetermined coefficients</a></li>
<li><a href="fl-models.html" data-scroll="fl-models">Modeling with first-order ODEs</a></li>
<li><a href="fl-impulse.html" data-scroll="fl-impulse">Steps and impulses</a></li>
<li><a href="fl-laplace.html" data-scroll="fl-laplace">Laplace transform methods</a></li>
</ul>
</li>
<li class="link">
<a href="ch3-first-order-systems.html" data-scroll="ch3-first-order-systems"><span class="codenumber">3</span> <span class="title">First-order linear systems</span></a><ul>
<li><a href="fs-structure.html" data-scroll="fs-structure">Structure of linear ODE systems</a></li>
<li><a href="fs-homogeneous.html" data-scroll="fs-homogeneous">Homogeneous systems</a></li>
<li><a href="fs-constcoeff.html" data-scroll="fs-constcoeff">Constant-coefficient systems</a></li>
<li><a href="fs-complex-exponentials.html" data-scroll="fs-complex-exponentials">Complex exponentials</a></li>
<li><a href="fs-phaseplane.html" data-scroll="fs-phaseplane">Phase plane</a></li>
<li><a href="fs-matrix-exp.html" data-scroll="fs-matrix-exp">Matrix exponential</a></li>
<li><a href="fs-varparam.html" data-scroll="fs-varparam">Variation of parameters</a></li>
</ul>
</li>
<li class="link">
<a href="ch4-second-order-linear.html" data-scroll="ch4-second-order-linear"><span class="codenumber">4</span> <span class="title">Second-order ODEs</span></a><ul>
<li><a href="so-convert.html" data-scroll="so-convert">Order equals dimension</a></li>
<li><a href="so-homogeneous.html" data-scroll="so-homogeneous">Homogeneous problem</a></li>
<li><a href="so-undetermined.html" data-scroll="so-undetermined">Undetermined coefficients</a></li>
<li><a href="so-oscillators.html" data-scroll="so-oscillators">Oscillators</a></li>
<li><a href="so-expforcing.html" data-scroll="so-expforcing">Driven oscillator</a></li>
<li><a href="so-laplace.html" data-scroll="so-laplace">Laplace transform methods</a></li>
<li><a href="so-laplace-repeated.html" data-scroll="so-laplace-repeated">Repeated and complex poles</a></li>
<li><a href="so-convolutions.html" data-scroll="so-convolutions">Convolutions</a></li>
</ul>
</li>
<li class="link">
<a href="ch5-nonlinear-ode.html" data-scroll="ch5-nonlinear-ode"><span class="codenumber">5</span> <span class="title">Nonlinear ODEs</span></a><ul>
<li><a href="nl-autonomous.html" data-scroll="nl-autonomous">Autonomous scalar problems</a></li>
<li><a href="nl-separable.html" data-scroll="nl-separable">Separable equations</a></li>
<li><a href="nl-logistic.html" data-scroll="nl-logistic">Case study: Logistic equation</a></li>
<li><a href="nl-directionfields.html" data-scroll="nl-directionfields">Direction fields</a></li>
<li><a href="nl-linearization.html" data-scroll="nl-linearization">Linearization</a></li>
</ul>
</li>
<li class="link"><a href="backmatter-1.html" data-scroll="backmatter-1"><span class="title">Back Matter</span></a></li>
<li class="link"><a href="appendix-1.html" data-scroll="appendix-1"><span class="codenumber">A</span> <span class="title">Notation glossary</span></a></li>
<li class="link"><a href="index-1.html" data-scroll="index-1"><span class="title">Index</span></a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="fl-varparam"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">2.4</span> <span class="title">Variation of parameters</span>
</h2>
<a href="fl-varparam.html" class="permalink">¶</a><p id="p-219">In this and the next section we turn to looking for particular solutions of the first-order linear ODE</p>
<div class="displaymath">
\begin{equation}
x'-a(t)x=f(t)\text{,}\label{fl-eq-folinrepeat}\tag{2.4.1}
\end{equation}
</div>
<p data-braille="continuation">or \(\opA[x]=f\text{.}\) We start in this section with an all-purpose method. In the next section we look at a method that's simpler for the most common problems.</p>
<p id="p-220">We begin with the homogeneous solution</p>
<div class="displaymath">
\begin{equation*}
x_h(t) = c_1 g(t) = c_1 \exp\left[\int a(t)\, dt\right]\text{,}
\end{equation*}
</div>
<p data-braille="continuation">where \(g(t)\) is the integrating factor from <a class="xref" data-knowl="./knowl/fl-eq-intfactor.html" title="Equation 2.3.1">(2.3.1)</a>. The idea of <dfn class="terminology">variation of parameters</dfn> is to posit that the particular solution can be written by replacing the constant with a function,</p>
<div class="displaymath">
\begin{equation}
x_p(t) = k(t) g(t)\text{,}\label{fl-eq-vofp1}\tag{2.4.2}
\end{equation}
</div>
<p data-braille="continuation">and then choose \(k(t)\) to make it so:</p>
<div class="displaymath">
\begin{equation*}
f(t) = x_p' - a(t) x_p = [k'g+kg'] - a k g = k'g + k[g'-ag]\text{,}
\end{equation*}
</div>
<p data-braille="continuation">which, because \(g\) is a homogeneous solution, is simply \(f(t)=k'(t)g(t)\text{.}\) Hence we get a proper particular solution provided</p>
<div class="displaymath">
\begin{equation}
k(t) = \int \frac{f(t)}{g(t)}\, dt \text{.}\label{fl-eq-vofp2}\tag{2.4.3}
\end{equation}
</div>
<p data-braille="continuation">Step by step, we have to (1) integrate once to get \(g\) in <a class="xref" data-knowl="./knowl/fl-eq-intfactor.html" title="Equation 2.3.1">(2.3.1)</a>, (2) integrate again to get \(k\) in <a class="xref" data-knowl="./knowl/fl-eq-vofp2.html" title="Equation 2.4.3">(2.4.3)</a>, and (3) multiply them together to get the particular solution in <a class="xref" data-knowl="./knowl/fl-eq-vofp1.html" title="Equation 2.4.2">(2.4.2)</a>. It's probably also worth mentioning step (0), which is to put the given problem in the standard form of <a class="xref" data-knowl="./knowl/fl-eq-folinrepeat.html" title="Equation 2.4.1">(2.4.1)</a>; i.e., divide the equation through by any coefficient of \(x'\text{.}\)</p>
<article class="example example-like" id="example-33"><a data-knowl="" class="id-ref original" data-refid="hk-example-33"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.4.1</span><span class="period">.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-33"><article class="example example-like"><p id="p-221">Consider \(3x'=12x+24t\text{.}\) Rewriting it as \(x'-4x=8t\text{,}\) we identify \(a(t)=4\) and \(f(t)=8t\text{.}\) Then</p>
<div class="displaymath">
\begin{equation*}
g(t) = \exp\left[ \int 4\,dt \right] = e^{4t}\text{,}
\end{equation*}
</div>
<p data-braille="continuation">and</p>
<div class="displaymath">
\begin{equation*}
k(t) = \int \frac{8t}{e^{4t}}\, dt = -\frac{1}{2} (4t+1)e^{-4t}\text{,}
\end{equation*}
</div>
<p data-braille="continuation">where you need integration by parts (or a computer) to perform the integral. Hence</p>
<div class="displaymath">
\begin{equation*}
x_p(t) = \left[ \frac{1}{2} (4t+1)e^{-4t} \right] e^{4t} = -\frac{1}{2} (4t+1)\text{,}
\end{equation*}
</div>
<p data-braille="continuation">and the general solution is</p>
<div class="displaymath">
\begin{equation*}
x(t) = x_h(t) + x_p(t) = c_1 e^{4t} - \frac{1}{2} (4t+1)\text{.}
\end{equation*}
</div></article></div>
<article class="example example-like" id="example-34"><a data-knowl="" class="id-ref original" data-refid="hk-example-34"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.4.2</span><span class="period">.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-34"><article class="example example-like"><p id="p-222">For \((2+t) x'= x - 1\text{,}\) we rewrite as</p>
<div class="displaymath">
\begin{equation*}
x' - \frac{1}{2+t} x = -\frac{1}{2+t}\text{.}
\end{equation*}
</div>
<p data-braille="continuation">Then</p>
<div class="displaymath">
\begin{equation*}
g(t) = \exp\left[ \int \frac{1}{2+t}\, dt \right] = \exp[ \ln(2+t) ] = 2+t\text{.}
\end{equation*}
</div>
<p data-braille="continuation">Next,</p>
<div class="displaymath">
\begin{equation*}
k(t) = \int \frac{-1}{2+t} (2+t)^{-1} \, dt = - (2+t)^{-1}\text{,}
\end{equation*}
</div>
<p data-braille="continuation">so that</p>
<div class="displaymath">
\begin{equation*}
x(t) = c_1 (2+t) - (2+t)^{-1} (2+t) = c_1(2+t)-1\text{.}
\end{equation*}
</div></article></div>
<p id="p-223">After being thoroughly trained to always include integration constants, you might wonder why we are being so cavalier about them here. Let's walk through what would happen to them in the last example above. First,</p>
<div class="displaymath">
\begin{equation*}
g(t) = \exp\left[  \ln(2+t) + C_1 \right] = A_1(2 + t)\text{,}
\end{equation*}
</div>
<p data-braille="continuation">where we renamed \(A_1=e^{C_1}\gt 0\text{.}\) Then</p>
<div class="displaymath">
\begin{equation*}
k(t) = A_1^{-1} \int \frac{-1}{2+t} (2+t)^{-1} \, dt = A_1^{-1} [-(2+t)^{-1}+C_2] = -A_1^{-1}(2+t)^{-1} + A_2\text{.}
\end{equation*}
</div>
<p data-braille="continuation">Finally,</p>
<div class="displaymath">
\begin{equation*}
x = x_h + kg = c_1 A_1(2 + t) + \bigl[-A_1^{-1}(2+t)^{-1} + A_2\bigr ]A_1(2 + t) = (c_1A_1+A_1A_2)(2+t) - 1\text{.}
\end{equation*}
</div>
<p data-braille="continuation">This is exactly the same family of solutions as \(c_1(2+t)-1\text{.}\) Essentially, all the integration constants end up lumped into that \(c_1\text{,}\) which is always the case.</p>
<p id="p-224">For initial-value problems, we find the entire general solution first, and then apply the initial condition to get a specific value for the free constant.</p>
<article class="example example-like" id="example-35"><a data-knowl="" class="id-ref original" data-refid="hk-example-35"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.4.3</span><span class="period">.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-35"><article class="example example-like"><p id="p-225">Above we found that the general solution of \(x'=4x+8t\) is \(x(t)=c_1 e^{4t} - \frac{1}{2} (4t+1)\text{.}\) If we also have that \(x(0)=3/2\text{,}\) then we can conclude</p>
<div class="displaymath">
\begin{equation*}
\frac{3}{2} = x(0) = c_1 - \frac{1}{2}(1)\text{,}
\end{equation*}
</div>
<p data-braille="continuation">so \(c_1=2\text{.}\)</p></article></div></section></div></main>
</div>
<div class="login-link"><span id="loginlogout" class="login">login</span></div>
<script src="https://pretextbook.org/js/0.13/login.js"></script>
</body>
</html>
