<?xml version="1.0" encoding="UTF-8" ?>

<chapter xml:id="ch2-first-order-linear" xmlns:xi="http://www.w3.org/2001/XInclude">
<title>First-order linear ODEs</title>

<section xml:id="fl-linearity">
	<title>Introduction</title>
	<!--p><em>Refer to section 1.1 of the text.</em></p-->

	<p>
		A <term>differential equation</term> is an equation that has some derivatives in it. (Duh.) The variable whose derivative is taken is called the <idx>dependent variable</idx><term>dependent variable</term> and is considered the "unknown" of the differential equation. We'll be concerned with the case where there is only one <idx>independent variable</idx><term>independent variable</term>  (a "with respect to" variable in the denominator of a derivative), so there are no partial derivatives and we say the equation is  an <term>ordinary differential equation</term>, or ODE. For discussions and theory we will stick to <m>x</m> and <m>t</m> as the dependent and independent variables, but in general these are determined by what is being modeled by the ODE.
	</p>

	<p>
		If only first derivatives appear (that is, no <m>x''</m>, <m>x'''</m>, etc.), it's a <term>first-order</term> ODE. We're going to stick to this kind of ODE for a while.
	</p>

	<p>
		The easiest ODE in the world is
		<me> \dd{x}{t} = 0</me>.
		A <idx><h>solution</h><h>of ODE</h></idx><term>solution</term> of this ODE is a function <m>x(t)</m> that satisfies the ODE. Perhaps you can work out that the solution here is <m>x(t)=C</m> for an arbitrary constant <m>C</m>. As dumb as this example is, it points out something important right away.
	</p>
	<fact>
		<p>Solutions to ODEs are not unique.</p>
	</fact>
	<p>
		More general, but not really any more new to you, is the ODE <m>\dd{x}{t}=f(t)</m>. Both sides can be integrated to give <m>x(t) = \int f(t)\,dt + C</m>.
	</p>
	<p>
		Things get interesting only when both <m>x</m> and <m>x'</m> appear in the equation. We'll use four examples or archetypes to begin the discussion.
	</p>
	<example xml:id="ex-constant-growth">
		<title>Constant growth rate</title>
		<p>
			<me>\dd{x}{t} = x</me>
			It's trivial to check that <m>x=e^t</m> is one solution of <m>x'=x</m>, i.e.,  it makes the ODE a true equation.  As a mathematical model, the ODE states that the rate of change in <m>x</m> is equal to <m>x</m> itself, and the result is <idx>exponential growth</idx><term>exponential growth</term>: the solution grows larger, which increases the rate of growth, and so on in a feedback loop.
		</p>
		<p>
			Exponential growth is most naturally plotted on a log-linear graph, in which case the solution is a straight line with positive slope. Because of the log scale, a <q>difference</q> in the <m>y</m>-coordinate is actually a multiplicative factor in the solution. Thus each unit of time applies a constant multiplier of growth.
		</p>
		<sidebyside>
			<listing xml:id="fo_intro_const_growth">
			<caption>Exponential growth.</caption>
			<program language="matlab">
			<input>
				x = @(t) exp(t);
				fplot(x,[0,4]), set(gca,'yscale','log')
				xlabel('t'), ylabel('x(t)')
				title('Exponential growth')
			</input>
			</program>
			</listing>
			<image source="figures/fo_intro_const_growth.svg"/>
		</sidebyside>
	</example>

	<example xml:id="ex-constant-decay">
			<title>Constant decay rate</title>
		<p>
			<me>\dd{x}{t} = -x</me>
			Now the model states that the rate of change is negative when <m>x</m> is positive (and vice versa). So a positive starting value will decrease, but the rate of decrease will then lessen, etc. From this qualitative description alone it's impossible to tell whether the solution ever reaches zero--at which point its rate of change would be zero.
		</p>
		<p>
			But we can end the suspense by easily verifying that <m>x=e^{-t}</m> is a solution. This function asymptotically approaches zero as <m>t\to\infty</m>, which we call <idx>exponential decay</idx><term>exponential decay</term>. In other, related problems we will find that solutions can decay (or "relax") to any value, not just zero.
		</p>
		<p>
			Exponential decay is most naturally plotted on a log-linear graph, in which case the solution is a straight line with negative slope.
		</p>
		<sidebyside>
			<listing xml:id="fo_intro_const_decay">
				<caption>Exponential decay.</caption>
			<program language="matlab">
			<input>
				x = @(t) exp(-t);
				fplot(x,[0,4]), set(gca,'yscale','log')
				xlabel('t'), ylabel('x(t)')
				title('Exponential decay')
			</input>
			</program>
			</listing>
			<image source="figures/fo_intro_const_decay.svg"/>
		</sidebyside>

	</example>

	<example xml:id="ex-variable-growth">
		<title>Variable growth rate</title>
		<p>
		<me>\dd{x}{t} = 2tx</me>
		In this case we are back to a positive growth rate for positive solution values. In fact, the growth rate increases with time as well as with the solution itself. You can verify that <m>x=e^{t^2}</m> is a solution, and indeed this grows at a "super-exponential" rate.
		</p>
		<sidebyside>
			<listing  xml:id="fo_intro_var_growth">
			<program language="matlab">
			<input>
				x = @(t) exp(t.^2);
				fplot(x,[0,4]), set(gca,'yscale','log')
				xlabel('t'), ylabel('x(t)')
				title('Variable growth')
			</input>
			</program>
			</listing>
			<image source="figures/fo_intro_var_growth.svg"/>
		</sidebyside>

	</example>

	<example xml:id="ex-nonlinear-growth">
		<title>Nonlinear growth</title>
		<p>
			<me>\dd{x}{t} = x^2</me>
			This is our first example featuring a nonlinear term in the variable <m>x</m>. As a rule, nonlinear ODEs are much harder to solve and have less mathematical structure than linear problems. This particular example isn't so tough, though; you can check that <m>x=1/(1-t)</m> is a solution. Note that the growth is even faster--literally off the charts as <m>t\to 1</m>.
		</p>
		<sidebyside>
			<listing xml:id="fo_intro_nonlin_growth">
			<program language="matlab">
			<input>
				x = @(t) 1./(1-t);
				fplot(x,[0,1]), set(gca,'yscale','log')
				xlabel('t'), ylabel('x(t)')
				title('Nonlinear growth')
			</input>
			</program>
			</listing>
			<image source="figures/fo_intro_nonlin_growth.svg"/>
		</sidebyside>
		<aside>
			<p>
				You might wonder about the validity of any mathematical model that leads to an infinite result in finite time. But this particular ODE describes, for instance, the evolution of the slope of the line of sight to an airplane flying straight over you. When the airplane is directly overhead, the slope is infinite. So while the model becomes mathematically invalid at that moment, it does describe a real physical situation.
			</p>
		</aside>
	</example>
</section>

<section xml:id="fl-linear-ode">
	<title>Linear ODEs</title>
	<introduction>
		<p>
			Linear ODEs are the most fundamental type. If you could only get to ask one yes-or-no question about a new ODE, your question should be, "Is it linear?"
		</p>
		<definition xml:id="fl-df-linear-ode">
			<title>First-order linear ODE</title>
			<statement>
			<p>
				A <idx><h>linear ODE</h><h>first order</h></idx><term>first-order linear ODE</term> is an equation of the form
				<men xml:id="fl-eq-linear">
					\dd{x}{t} = a(t)x + f(t)
				</men>.
			</p></statement>
		</definition>
		<p>
			We often refer to <m>a(t)</m> as the <idx><h>coefficient</h><h>in linear ODE</h></idx><term>coefficient function</term> and <m>f(t)</m> as the <idx>forcing function</idx><term>forcing function</term>.
			Note that it is <em>not</em> necessary for these to be linear functions of time, nor is the solution <m>x(t)</m> generally a linear function. The linearity being referred to is the fact that there are no terms such as <m>\sin(x')</m>, <m>e^x</m>, <m>xx'</m>, etc.
		</p>
	</introduction>
	<subsection xml:id="fl-li-general">
		<title>General solutions</title>
		<p>
			All solutions to first-order linear problems share a basic structure. In fact, it's the same structure as the solutions of <m>\bA\bx=\bb</m>. In order to describe this, we're going to replace the vectors <m>\bx</m> and <m>\bb</m> with the functions <m>x(t)</m> and <m>f(t)</m>, and the matrix <m>\bA</m> by something analogous for functions.
		</p>
		<definition xml:id="fl-df-operator">
			<title>Linear operator</title>
			<statement><p>
				A <idx>linear operator</idx><term>linear operator</term> <m>\opA</m> is a rule for transforming functions to other functions, such that
				<me>
					\opA[cx(t) + y(t)]=c\opA[x(t)] + \opA[y(t)]
				</me>
				for all functions <m>x,y</m> and numbers <m>c</m>.
			<notation>
			  <usage>\opA[x]</usage>
			  <description>linear operator applied to a function</description>
			</notation>
			</p></statement>
		</definition>
		<p>
			In the first chapter we pointed out that the linear function <m>L</m> defined by ><m>L(\bx)=\bA\bx</m> for a given matrix <m>\bA</m> has the same property. In the context of the first order linear ODE <xref ref="fl-eq-linear"/>, the operator of interest to us is defined by
			<men xml:id="fl-eq-linop">
				\opA[x] = x' - a(t)x
			</men>,
			whose linearity you can easily validate for yourself. We can now express the ODE simply as <m>\opA[x]=f</m>.
		</p>
		<p>
			As with linear systems, we have a special role for the <idx><h>homogeneous</h><h>linear ODE</h></idx><term>homogeneous</term> linear ODE <m>\dd{x}{t} = a(t)x</m>, that is, <m>\opA[x]=0</m>, or equation <xref ref="fl-eq-linear"/> with zero forcing.
		</p>
		<fact>
			<p>
				If <m>x_1(t)</m> and <m>x_2(t)</m> are solutions of <m>\opA[x]=0</m>, then so is any linear combination <m>c_1x_1 + c_2x_2</m> for constants <m>c_1,c_2</m>.
			</p>
		</fact>
		<p>
			Quite simply, this is because
			<me>\opA[c_1x_1 + c_2x_2] = c_1\opA[x_1] + c_2\opA[x_2]=0+0=0</me>.
			Clearly, we could extend the linear combination to any number of terms, with the same result. We can make a related observation:
		</p>
		<fact>
			<p>
				If <m>x_h</m> is a solution of the homogeneous <m>\opA[x]=0</m> and <m>x_p</m> is any particular solution of <m>\opA[x]=f</m>, then <m>x=x_h+x_p</m> is also a solution of <m>\opA[x]=f</m>.
			<notation>
			  <usage>x_h</usage>
			  <description>homogeneous solution (ODE)</description>
			</notation>
			<notation>
			  <usage>x_p</usage>
			  <description>particular solution (ODE)</description>
			</notation>
			</p>
		</fact>
		<p>
			This is just as easy as the last fact:
			<me>\opA[x_h+x_p] = \opA[x_h] + \opA[x_p]=0+f=f</me>.
			As with linear systems, then, we can boil the general solution of the complete problem to finding the most general solution of the homogeneous problem, plus a particular solution of the original problem.
		</p>
		<theorem xml:id="fl-general">
			<title>General solutions (first-order linear ODEs)</title>
			<statement><p>
				Every solution of the ODE <m>\opA[x]=f</m> can be written in the form <m>x=x_h+x_p</m>, where <m>x_h</m> is the general solution of <m>\opA[x]=0</m> and <m>x_p</m> is any solution of <m>\opA[x]=f</m>.
			</p></statement>
		</theorem>
	</subsection>
</section>

<section xml:id="fl-homogeneous">
	<title>Homogeneous solutions</title>
	<introduction>
		<p>
			Our first job is to figure out how to express all possible solutions of the homogeneous problem <m>\opA[x]=0</m>, or <m>x'-a(t)x=0</m>. As with linear systems, the goal is to find a basis, so that the general <m>x_h</m> is a linear combination of the basis functions. However, there is no analog of the RREF of a matrix to exploit here.
		</p>
	</introduction>
	<subsection xml:id="fl-ho-intfactor">
		<title>Exponential solution</title>
		<p>
			We can go far with some simple calculus. Let's try an exponential solution, 
			<me>
				x(t) = \exp[ q(t) ]
			</me>,
			for a <m>q(t)</m> to be defined momentarily. Then by the chain rule,
			<me>
				x'(t) = q'(t) x(t)
			</me>.
			So <m>x</m> is a solution of <m>x'-a(t)x=0</m> if <m>a(t)=q'(t)</m>, that is, <m>q</m> is an antiderivative of <m>a</m>. The general homogeneous solution is thus
			<men xml:id="fl-eq-intfactor">
					x_h(t) = c_1 \exp\left( \int a(t)\,dt \right)
			</men>,
			for arbitrary constant <m>c_1</m>. It's implicit that any antiderivative can be used here; i.e., the <q>plus C</q> you usually have to include can just be left out, because it's absorbed into <m>c_1</m> anyway. 
		</p>
		<aside>
			<p>
				The indefinite integral in the solution has an additive arbitrary constant. But adding <m>C</m> to the integral is the same as multiplying the solution by <m>e^C</m>, so the general homogeneous solution is not affected. This is the usual situation of scalar nonuniqueness for expressing the basis of a nullspace.
			</p>
		</aside>
		<example>
			<p>
				To solve <m>x'=\sin(t) x</m>, we integrate to get <m>-\cos(t)</m> and then exponentiate, so that
				<me>
					x_h(t) = c_1 \exp[ -\cos(t) ]
				</me>.
			</p>
		</example>
	</subsection>
	<subsection xml:id="fl-ho-ivp">
		<title>Initial-value problems</title>
		<p>
			The general solution of <m>x'=a(t)x+f(t)</m> includes the general homogeneous solution, which contains an arbitrary multiplicative constant. This <q>solution</q> is therefore really a family of solutions. Many models include one piece of additional information that specifies the solution uniquely.
		</p>
		<definition xml:id="fl-df-ivp">
			<title>Initial value problem (IVP)</title>
			<statement><p>
				A first-order <idx><h>initial value problem</h><h>first-order</h></idx><term>initial value problem</term> is a first-order ODE together with an <term>initial condition</term> <m>x(t_0)=x_0</m>.
			</p></statement>
		</definition>
		<aside>
			<p>
				The definition of IVP, unlike most of what we have done so far, applies to nonlinear ODEs as well as linear ones.
			</p>
		</aside>
		<p>
			Solving an IVP typically involves first finding the general solution of the ODE, then applying the initial condition to determine a specific value for the integration constant.
		</p>
		<example>
			<p>
				We found earlier that the general solution of <m>x'=\sin(t) x</m> is
				<me>
					x(t) = c_1 \exp[ -\cos(t) ]
				</me>.
				If we are also given the initial condition <m>x(0)=1</m>, then we substitute to determine
				<me>
					1 = x(0) = c_1 e^{-\cos(0)} = \frac{c_1}{e}
				</me>,
				so that <m>c_1=e</m>. We then write
				<me>
						x(t) = e \exp[ -\cos(t) ] = \exp[1-\cos(t)]
				</me>,
				which has no arbitrary constants left.
			</p>
		</example>
	</subsection>
	<!--subsection xml:id="fl-iv-growth">
		<title>Growth factor</title>
		<p>
			Another option is to rewrite some formulas for the IVP case. Consider again the integrating factor,
			<me>
				g(t) = \exp\left[ \int a(t)\, dt \right]
			</me>.
			It is not uniquely defined thanks to the integration constant. For an ODE alone this is natural, as the solution itself is not unique. But for the IVP we can define
			<men xml:id="fl-eq-growthfactor">
				G(s,t) = \exp\left[ \int_{s}^t a(u)\, du \right]
			</men>,
			which we call the <idx>growth factor</idx><term>growth factor</term>. It has some interesting and useful properties.
		</p>
		<theorem xml:id="fl-thm-growthfactor">
			<title>Growth factor</title>
			<statement>
				<p>
					<ol>
						<li><me>G(t,t)=1</me></li>
						<li><me>\frac{d}{dt} G(t_0,t) = a(t) G(t_0,t)</me></li>
						<li><me>G(s,r)G(r,t) = G(s,t)</me></li>
						<li><me>\frac{1}{G(s,t)}=G(t,s)</me></li>
						<li>The unique solution of <m>x'-ax=0</m>, <m>x(t_0)=x_0</m> is <m>G(t_0,t)x_0</m>.</li>
					</ol>
				</p>
			</statement>
		</theorem>
		<example>
			<p>
				Reconsider the previous IVP <m>x'=\sin(t) x</m>,  <m>x(0)=1</m>. First we find
				<me>
					G(s,t) = \exp \left[ \int_{s}^t \sin(u)\, du \right] = \exp[-\cos(t)+\cos(s)]
				</me>.
				The solution of the IVP is therefore
				<me>
					x(t) = G(0,t)\cdot 1 = \exp[1-\cos(t)]
				</me>,
				which is what we found before.
			</p>
		</example>
		<p>
			The growth factor has a simple interpretation: multiplication by <m>G(s,t)</m> represents the evolution of <m>x</m> from a state at time <m>s</m> to the state at time <m>t</m>. That makes the first three properties of <xref ref="fl-thm-growthfactor"/> seem pretty obvious.
		</p>
	</subsection-->
	<subsection xml:id="fl-iv-numerical">
		<title>Numerical solutions</title>
		<p>
			Because an IVP has a unique solution, it is a suitable target for an approximate numerical solution.
		</p>
		<example>
			<p>
				We look again at <m>x'=\sin(t) x</m>,  <m>x(0)=1</m>. Most numerical routines, like those in MATLAB, are coded to solve an ODE given in the general form <m>x'=F(t,x)</m>. Therefore we have to define a function for <m>F</m>.
		<cd>
F = @(t,x) sin(t)*x;
		</cd>
		Now we call the function <c>ode45</c> to solve the problem, designating times of interest and the initial value.
		<cd>
t = linspace(0,5,500);
[t,x] = ode45(F,t,1);
		</cd>
		The outputs here are vectors of equal length, giving the times we selected and values of the solution at those times. For instance, to get values at the final time we use
		<cd>
format long
[ t(end), x(end) ]
		</cd>
		and get the response
		<cd>
ans =
5.000000000000000   2.046942183624863
		</cd>
		The outputs are also in a form easy to plot.
		<cd>
plot(t,x)
xlabel('t'), ylabel('x(t)')
title('Solution of a linear problem')
		</cd>
		</p>
		<sidebyside>
			<image source="figures/fl_linear_first_ivp.svg"/>
		</sidebyside>
		</example>
	</subsection>
</section>

<section xml:id="fl-varparam">
	<title>Variation of parameters</title>
	<!--introduction-->
		<p>
			In this and the next section we turn to looking for particular solutions of the first-order linear ODE
			<men xml:id="fl-eq-folinrepeat">
				x'-a(t)x=f(t)
			</men>,
			or <m>\opA[x]=f</m>. We start in this section with an all-purpose method. In the next section we look at a method that's simpler for the most common problems.
		</p>
		<p>
			We begin with the homogeneous solution
			<me>
				x_h(t) = c_1 g(t) = c_1 \exp\left[\int a(t)\, dt\right]
			</me>,
			where <m>g(t)</m> is a shorthand for the exponential. The idea of <idx>variation of parameters</idx><term>variation of parameters</term> is to posit (i.e., guess) that the particular solution can be written by replacing the constant with a function,
			<men xml:id="fl-eq-vofp1">
				x_p(t) = k(t) g(t)
			</men>,
			and then choose <m>k(t)</m> to make it so:
			<me>
				f(t) = x_p' - a(t) x_p = [k'g+kg'] - a k g = k'g + k[g'-ag]
			</me>,
			which, because <m>g(t)</m> is a homogeneous solution, is simply <m>f(t)=k'(t)g(t)</m>. Hence we get a proper particular solution of the original problem provided <m>f=k'g</m>, or 
			<men xml:id="fl-eq-vofp2">
				k(t) = \int \frac{f(t)}{g(t)}\, dt
			</men>.
			Step by step, we have to (1) integrate <m>a(t)</m> once to get <m>g</m>, (2) integrate <m>f/g</m> to get <m>k</m> in <xref ref="fl-eq-vofp2"/>, and (3) multiply them together to get the particular solution in <xref ref="fl-eq-vofp1"/>. It's also worth reiterating the implicit step (0), which is to first of all put the given problem in the standard form of <xref ref="fl-eq-folinrepeat"/>; i.e., divide the equation through by any coefficient of <m>x'</m>.
		</p>	
		<aside>
			<p>The function <m>1/g</m> is often called an <term>integrating factor</term>. If you multiply the original equation by <m>1/g</m>, then the solution can be found by one more integration. It's the same result as we derived here.</p>
		</aside>
		<example>
			<p>
				Consider <m>3x'=12x+24t</m>. Rewriting it as <m>x'-4x=8t</m>, we identify <m>a(t)=4</m> and <m>f(t)=8t</m>. Then
				<me>
					g(t) = \exp\left[ \int 4\,dt \right] = e^{4t}
				</me>,
				and
				<me>
					k(t) = \int \frac{8t}{e^{4t}}\, dt = -\frac{1}{2} (4t+1)e^{-4t}
				</me>,
				where you need integration by parts (or a computer) to perform the integral. Hence
				<me>
					x_p(t) = \left[ \frac{1}{2} (4t+1)e^{-4t} \right] e^{4t} = -\frac{1}{2} (4t+1)
				</me>,
				and the general solution is
				<me>
					x(t) = x_h(t) + x_p(t) = c_1 e^{4t} - \frac{1}{2} (4t+1)
				</me>.
			</p>
		</example>
		<example>
			<p>
			  To find a particular solution of <m>x'=2tx + 6t</m>, we start with 
			  <me>
				  g(t) = \exp\left[ \int 2t\, dt \right] = e^{t^2} 
			  </me>. 
			  Then we can compute 
			  <me>
				  k(t) = \int \frac{6t}{e^{t^2}}\, dt  = -3 e^{-t^2}
			  </me>. 
			  Finally, 
			  <me>
				  x_p(t) = k(t) g(t) = -3
			  </me>,
			  and the general solution is <m>x(t)=c_1 e^{t^2}-3</m>.
			</p>
			<p>
			  (It should be clear that we needed a very special <m>f</m> to make the second integral feasible. If not, try reworking it for <m>f(t)=6</m> and you will quickly find yourself stuck, at least while using familiar functions.) 
			</p>
		</example>
		<example>
			<p>
				For <m>(2+t) x'= x - 1</m>, we first rewrite as
				<me>
					x' - \frac{1}{2+t} x = -\frac{1}{2+t}
				</me>. Then
				<me>
					g(t) = \exp\left[ \int \frac{1}{2+t}\, dt \right] = \exp[ \ln(2+t) ] = 2+t
				</me>.
				Next,
				<me>
					k(t) = \int \frac{-1}{2+t} (2+t)^{-1} \, dt = (2+t)^{-1}
				</me>,
				so that
				<me>
					x(t) = c_1 (2+t) + (2+t)^{-1} (2+t) = c_1(2+t)+1
				</me>.
			</p>
		</example>
		<p>
			Combining the expressions for both the homogeneous and particular parts, we obtained the full general solution
			<men xml:id="fl-eq-vofpgen">
				x(t) = c_1 \exp[q(t)] + \exp[q(t)] \int f(t) \exp[-q(t)]\, dt = \exp[q(t)] \left[ c_1  + \int f(t) \exp[-q(t)]\, dt \right]
			</men>,
			where as before, <m>q</m> is any antiderivative of <m>a(t)</m>. Writing the solution this way clarifies that once again the <q>plus C</q> of indefinite integration doesn't really matter, as it gets absorbed into the final arbitrary <m>c_1</m>. 
		</p>
		<p>
			For initial-value problems, we have two options. The first is the default: find the entire general solution, and then apply the initial condition to get a specific value for the free constant.
		</p>
		<example>
			<p>
				Above we found that the general solution of <m>x'=4x+8t</m> is <m>x(t)=c_1 e^{4t} - \frac{1}{2} (4t+1)</m>. If we also have that <m>x(0)=3/2</m>, then we can conclude
				<me>
					\frac{3}{2} = x(0) = c_1 - \frac{1}{2}(1)
				</me>,
				so <m>c_1=2</m>.
			</p>
		</example>
		<p>
			A slightly streamlined version of the process is available for IVPs. Given the initial condition <m>x(t_0)=x_0</m>, we rewrite the general solution <xref ref="fl-eq-vofpgen"/> using definite integrals:
			<me>
				q_0(t) = \int_{t_0}^t a(s)\, ds,
			</me>
			followed by
			<me>
				x(t) = \exp[q_0(t)] \left[ c_1  + \int_{t_0}^t f(s) \exp[-q_0(s)]\, ds \right]
			</me>. 
			By the properties of definite integrals, we know that <m>q(t_0)=0</m>, and hence 
			<me>
				x_0 = x(t_0) = 1\cdot \left[ c_1  + 0 \right]
			</me>. 
			So there is really no need to solve for the constant; the initial value can be baked in from the beginning:
			<me>
				x(t) = \exp[q_0(t)] \left[ x_0  + \int_{t_0}^t f(s) \exp[-q_0(s)]\, ds \right]
			</me>. 		
		</p>
		<example>
			<p>
				Reconsider the previous example of <m>x'=4x+8t</m> with <m>x(0)=3/2</m>. Then 
				<me>
					q_0(t) = \int_0^t 4s\, ds = 4t
				</me>, 
				and
				<me>
					x(t) = e^{4t} \left[ \frac{3}{2}  + \int_{0}^t 8s e^{-4s}\, ds \right].
				</me>
				This evaluates to 
				<me>
					 x(t) = e^{4t} \left[ \frac{3}{2} + \frac{1}{2} \Bigl(1-e^{-4 t} (4 t+1)\Bigr) \right] = 2e^{4t} - \frac{1}{2}(4t+1)
				</me>,
				just as before. 
			</p>
		</example>
		<p>
			When the homogeneous and particular solutions are known or given, it's easier to write out the general solution and then find the constant in it. But starting from scratch, the definite integral approach is tidier. The overall difficulty is about the same.
		</p>

	<!--/introduction-->
</section>

<section xml:id="fl-undeter">
		<title>Undetermined coefficients</title>
		<introduction>
			<p>
				Variation of parameters is all that we technically need for linear first-order problems, but as we have seen, it requires some grunt work--in particular, two integrals. There is a significantly shorter path for <xref ref="fl-eq-linear"/> in the important special case when (1) the growth/decay rate coefficient <m>a(t)</m> is constant, and (2) the forcing function is a polynomial, exponential, sin, or cos, or a combination of these. In this situation, the correct <m>x_p</m> can be written down immediately up to some unknowns or <idx>undetermined coefficients</idx><term>undetermined coefficients</term>. Values for these coefficients are by substitution of <m>x_p</m> into the ODE. The correct form of <m>x_p</m> for various <m>f</m> are given in <xref ref="fl-tb-undeter"/>.
			</p>
			<table xml:id="fl-tb-undeter">
				<title>Particular solutions for undetermined coefficients.</title>
					<tabular>
						<row>
							<cell><m>\mathbf{f(t)}</m></cell>
							<cell><m>\mathbf{x_p(t)}</m></cell>
						</row>
						<row>
							<cell><m>b_n t^n + \cdots b_0</m></cell>
							<cell><m>B_n t^n + \cdots + B_0</m></cell>
						</row>
						<row>
							<cell><m>e^{rt}(b_n t^n + \cdots b_0)</m></cell>
							<cell><m>e^{rt}(B_n t^n + \cdots B_0)</m></cell>
						</row>
						<row>
							<cell><m>\cos(\omega t)</m></cell>
							<cell><m>A \cos(\omega t) + B \sin(\omega t)</m></cell>
						</row>
						<row>
								<cell><m>\sin(\omega t)</m></cell>
								<cell><m>A \cos(\omega t) + B \sin(\omega t)</m></cell>
							</row>
					</tabular>
			</table>
			<example>
				<p>
					To solve <m>x'+3x=6t</m>, first note that <m>x_h(t)=c_1e^{-3t}</m>. For <m>x_p</m> we use the educated guess
					<me>
						x_p(t) = B_1 t + B_0
					</me>.
					Substituting that into the ODE yields
					<me>
						(B_1)+3(B_1 t + B_0) = 6t
					</me>.
					This has to be identically true for all <m>t</m>. On matching like powers of <m>t</m> we get the equations <m>3B_1=6</m> and <m>B_1+B_0=0</m>. This is a linear system of two equations with two unknowns, but we don't need any fancy linear algebra to see that <m>B_1=2</m> and <m>B_0=-2/3</m>. So the general solution is
					<me>
						x(t) = c_1 e^{-3t} + 2t - \frac{2}{3}
					</me>.
				</p>
			</example>
			<example>
					<p>
						To solve <m>x'+x=-t e^t</m>, first note that <m>x_h(t)=c_1e^{-t}</m>. For <m>x_p</m> we use the educated guess
						<me>
							x_p(t) = (B_1 t + B_0)e^t
						</me>.
						Then 
						<me>
							x_p'(t) = (B_1 t + B_0)e^t + (B_1)e^t
						</me>
						
						Substituting that into the ODE yields
						<me>
							e^t(B_1t+B_0+B_1) + e^t(B_1 t + B_0) = -t e^t
						</me>.
						On canceling the exponentials and matching like powers of <m>t</m>, we get the equations <m>2B_1=-1</m> and <m>2B_0+B_1=0</m>. Hence <m>B_1=-1/2</m> and <m>B_0=1/4</m>. So the general solution is
						<me>
							x(t) = c_1 e^{-t} + \frac{1-2t}{4}\, e^t
						</me>.
					</p>
			</example>
			<p>
					An important aspect of the previous two examples is that if the forcing function <m>f</m> includes a polynomial, then the particular solution has to include all the terms for a polynomial of the same degree, even if the forcing polynomial has some zero coefficients. Similarly, if <em>either</em> sin or cos appears in <m>f</m>, then <em>both</em> sin and cos have to be included in the form of <m>x_p</m>.
			</p>
			<example>
				<p>
					Let's solve <m>x'=3x+50\cos(4t)</m>. We have <m>x_h=c_1e^{3t}</m> and choose
					<me>
						x_p = A \cos(4t) + B\sin(4t)
					</me>.
					Put this into the ODE to get
					<me>
						[-4A\sin(4t) + 4B\cos(4t)] - 3[A \cos(4t) + B\sin(4t)] = 50\cos(4t)
					</me>.
					Matching the coefficients of cosine and sine leads to
					<me>
						4B-3A = 50, \quad -4A-3B = 0
					</me>.
					This is the linear system
					<me>
						\twomat{-3}{4}{-4}{-3} \twovec{A}{B} = \twovec{50}{0}
					</me>.
					We apply Cramer's Rule to get
					<me>
						A = \frac{ \twodet{50}{4}{0}{-3} }{9+16} = -6, \quad B = \frac{ \twodet{-3}{50}{-4}{0} }{9+16} = 8
					</me>.
					Thus finally
					<me>
						x(t) = c_1e^{3t} + 8\cos(4t) - 6 \sin(4t)
					</me>.
				</p>
			</example>
			<p>
				If the forcing function includes multiple different types of functions added together, then you can find particular solutions for the different terms separately and add them together to get the overall particular solution. 
			</p>
			<example>
				<p>
					To find a particular solution of  <m>x'+3x=6t-4e^{-t}</m>, we can separately find them for the cases <m>x'+3x=6t</m> and <m>x'+3x=-4e^{-t}</m>. Above we found <m>x_p=2t-(2/3)</m> for the first case. For the second case we choose <m>x_p=A e^{-t}</m> and plug in: 
					<me>
						-4e^{-t} = x'+3x = -A e^{-t} + 3A e^{-t}
					</me>,
					which tells us that <m>A=-2</m>. Finally, the particular solution of the original equation is 
					<me>
						x_p(t) = 2t-\frac{2}{3}-2e^{-t}
					</me>.
				</p>		
			</example>
		</introduction>
		<subsection xml:id="fl-uc-breakdown">
			<title>Breakdown of the method</title>
			<p>
				The suggestions in <xref ref="fl-tb-undeter"/> can fail if the forcing <m>f</m> includes the homogeneous solution <m>e^{at}</m>.
			</p>
			<example>
				<p>
					Consider <m>x'-ax=e^{at}</m>. We get <m>x_h=c_1e^{at}</m>, and the table suggests
					<me>
						x_p = B_0 e^{at}
					</me>.
					But this is a repeat of the homogeneous solution. Hence if we substitute it into <m>x'-ax</m>, we (naturally) get zero, and it's impossible to match this with the forcing function <m>e^{at}</m>.
				</p>
			</example>
			<p>
				The example above is a failure of the method, not a statement about the existence of the solution. There are advanced rules for fixing the method of undetermined coefficients in this circumstance, but it's simpler to just fall back to variation of parameters (<xref ref="fl-varparam"/>).
			</p>
			<example>
					<p>
						We solve <m>x'-ax=e^{at}</m> by the variation of parameters formula
						<me>
							x(t) = c_1 g(t) + g(t) \int g(t)^{-1} e^{at} \, dt
						</me>,
						where
						<me>
							g(t) = \exp \left( \int a\, dt \right) = e^{at}
						</me>.
						Hence
						<me>
								x(t) = c_1 e^{at} + e^{at} \int e^{-at} e^{at} \, dt = c_1 e^{at} + t e^{at}
						</me>.
					 </p>
			</example>

		</subsection>
</section>

<section xml:id="fl-models">
	<title>Modeling with first-order ODEs</title>

	<p>First-order ODEs are often used to model situations of growth and decay. The linear problem <m>x'=ax+f(t)</m> is a prototype for many important problems:
	<dl>
		<li><title>Population</title><p>Population <m>x(t)</m> of organisms has a constant net per-capita birth (or death) rate</p></li>
		<li><title>Interest</title><p>Money amount <m>x(t)</m> grows at fixed positive interest rate <m>a</m></p></li>
		<li><title>Radioactivity</title><p><m>x(t)</m> is the mass of a radioactive isotope, and <m>a \lt 0</m></p></li>
		<li><title>Pharmacokinetics</title><p> <m>x(t)</m> is the amount of a drug being metabolized in the body</p></li>
		<li><title>Newtonian cooling</title><p>If <m>x(t)</m> is the temperature of a body kept in an
		environment at fixed temperature <m>E</m>, then the difference <m>z(t)=x(t)-E</m> satisfies
		<m>z'=a z</m> for a cooling rate <m>a \lt 0</m></p></li>
	</dl>
	To belabor the obvious, positive <m>a</m> represents growth and negative <m>a</m> leads to decay. In the simplest contexts, the rate <m>a</m> is constant, but in most models a variable rate is more realistic.
	</p>

	<aside>
	<p>
		Interest rates in the real world may be quoted yearly, or quarterly, or according to any other finite time period. The rate in an ODE model is the <em>continuously compounded</em> rate.
	</p>
	</aside>

	<p>
		The units of the derivative <m>dx/dt</m> are those of <m>x</m> divided by those of <m>t</m>. Let's write these as <m>X/T</m>. Additive terms all need to have the same units, so both <m>f(t)</m> and <m>a(t)x</m> have those units as well. Consequently <m>a</m> has units <m>1/T</m> and has various interpretations when inverted:
		<ul>
			<li>When <m>a \lt 0</m>, the time <m>\tau=-1/a</m> is the <term>relaxation time</term> or <term>characteristic time</term>. If there is no forcing, then <m>x(\tau)= e^{-1} x(0) \approx 0.37 x(0)</m>. </li>
			<li>In radioactivity it's more common to use <m>t_h=-\ln(2)/a</m>, which is the <term>half-life</term>. That's because <m>\exp(at_h)=1/2</m>, so half of the radioactive isotope is depleted in that much time.</li>
			<li>Similarly, in population or another growth situation with <m>a \gt 0</m>, the time <m>t_D=\ln(2)/a</m> is the <term>doubling time</term>. Note that populations and interest don't grow arithmetically, like <m>1,2,3,4,\ldots</m>, but geometrically, like <m>1,2,4,8,\ldots</m>.</li>
		</ul>
	</p>

	<example>
		<title>First-order pharmacokinetics</title>
		<p>
			According to <em>R. Newton et al., “Plasma and salivary pharmacokinetics of caffeine in man,” European Journal of Clinical Pharmacology 21 (1981), pp. 45–52</em>, caffeine in the bloodstream approximately satisfies first-order kinetics, though the half-life varies a great deal from one person to the next.
		</p>
		<p>
			Suppose <m>t_h=6</m> hours. We can calculate <m>a=-\ln(2)/t_h\approx -0.116</m> per hour, and then the predicted effects of one cup of coffee are <m>x(t) = e^{-0.116t}x(0)</m>. You can check that an equivalent, more direct expression is
			<me>x(t) = 2^{-t/t_h} x(0)</me>.
		</p>
	</example>
	<p>
		A <term>continuously stirred tank reactor</term> (CSTR) appears often in chemical engineering. One ideally assumes that the contents of the tank are mixed perfectly and instantaneously at all times. Then one writes an ODE that expresses mass balance.
	</p>
	<example>
		<title>Stirred tank</title>
		<statement>
			<p>A 200 L tank contains 10 kg of dye. Pure water is added at a rate of 4 L per minute, while the mixture is drained at the same rate. How much dye is in the tank after 10 minutes?</p>
		</statement>
		<solution>
			<p>
				Let <m>x(t)</m> be the mass of dye in the tank. The trick is to realize how rapidly it is being removed, and that depends on the time-varying concentration, <m>x(t)/200</m>. Specifically,
				<me>\dd{x}{t} = - \frac{4 \text{ L}}{\text{minute}} \cdot \frac{x\, \text{ kg}}{200\, \text{ L}} = -0.02 x \text{ kg/min}</me>.
				So <m>x(t)=e^{-0.02 t}x(0)</m> and <m>x(10)=10 e^{-0.2}</m> kg.
			</p>
			<p>
				(These problems can also be solved by using concentration, not mass, as the dependent variable. Either is fine, so long as you are consistent.)
			</p>
		</solution>
	</example>

	<exercises xml:id="fl-exer-models">
		<title>Practice with models</title>
		<exercise>
			<title>Tank with changing volume</title>
			<statement>
			  <p>
				A 300 gal capacity tank initially holds 100 gal of a brine solution at 1 lb/gal.  A stream of brine at 2 lb/gal is poured into the tank at 3 gal/min, and an exit stream of the well-mixed solution leaves the tank at 2 gal/min.  Find the amount of salt in the tank at the time it is about to overflow.
			  </p>
			</statement>
			<answer>
			  <p>
				<m>\frac{5300}{9}\approx 589 \text{ lb.}</m>
			  </p>
			</answer>
			<solution>
			  <p>
				To write a rate equation for the amount <m>x(t)</m> of salt in the tank at time <m>t</m>, we use the principle of conservation of mass. We assume no reaction takes place in the tank, so that up to the moment of overflow we have 
				<me>
				\text{rate of change of } x = \text{(rate of salt in)} - \text{(rate of salt out)}
				</me>
				Let <m>V(t)=</m> the volume of the mixture at time <m>t</m>. Then
				<md>
					<mrow>\text{rate of salt in} \amp = 2 \text{ lb/gal }\times 3 \text{ gal/min }= 6 \text{ lb/min}</mrow>
					<mrow>\text{rate of salt out} \amp = \frac{x}{V} \text{ lb/gal }\times 2 \text{ gal/min }= \frac{2}{V}\,x \text{ lb/min.}</mrow>
				</md>
				Hence, 
				<me>
					\frac{dx}{dt} = 6 -  \frac{2}{V}\,x.
				</me>
				But the volume of the mixture changes as well (rate of change = rate in - rate out):
				<me>
					\frac{dV}{dt}= 3 - 2 = 1 \text{ gal/min } \; \Rightarrow\; V(t) = (t+100) \text{ gal, } 
				</me>
				where we have used the initial volume (100 gal) for the constant of integration.  Note that the time for overflow is when <m>V=300</m> gal, i.e. 200 min.
			</p>
			<p>	
				The initial amount of salt in the tank is 100 lb.  Using the volume expression, we obtain an IVP for <m>x(t)</m>, namely
				<md>
				<mrow> \frac{dx}{dt} \amp = 6 -  \frac{2}{t+100} x,\quad 0\lt t \le 200,</mrow>
				<mrow>x(0) \amp = 100. </mrow>
				</md>

				The ODE in standard form is 
				<me>
					x' + \frac{2}{t+100}x = 6,
				</me>
				which can be solved by variation of parameters: 
				<md>
					<mrow> g(t) \amp =\exp\left(\int -\frac{2}{t+100}\,dt\right)=(t+100)^{-2}, </mrow>
					<mrow>k(t) \amp = \int  6(t+100)^2\, dt = 2(t+100)^3,  </mrow>
					<mrow> x(t) \amp = c_1(t+100)^{-2} + 2(t+100)^{3-2}. </mrow>
				</md>
				Using the initial condition, we obtain <m>c_1=-100^3</m>. The time of overflow is <m>t=200</m> min, so finally we get 
				<me>
					x(200)=2(200+100)-\frac{100^3}{(200+100)^2}=\frac{5300}{9}\approx 589 \text{ lb.}
				</me>
			  </p>
			</solution>
		</exercise>
		<exercise>
			<title>Polluted lake</title>
			<statement>
				<p>
					A well-circulated lake contains 1000 kL of water that is initially at a concentration of 2 kg/kL of a pollutant.  Water from the effluent of a factory enters the lake at the rate of 5 kL/h with a concentration of 7 kg/kL of the pollutant.  Polluted water flows out of the lake through an outlet at the rate of 2 kL/h.  Determine the amount of pollutant in the lake as a function of time. (Ignore the fact that the lake may eventually overflow, as we are interested in a relatively short time.)
				</p>
			</statement>
			<hint>
			  <p>
				Write the IVP satisfied by the mass of pollutant using the principle of mass conservation. Note that the volume of the lake is not constant, and be very careful to match units.
			  </p>
			</hint>
			<answer>
			  <p>
				<m>7(3t+1000) - \frac{5\times 10^5}{(3t+1000)^{2/3}} \; \text{kg/kL.}</m>
			  </p>
			</answer>
			<solution>
				<p>
					It's clear that given the net fluid inflow rate of 3 kL/h, the lake volume is given by <m>V(t)=1000 + 3t</m> kL at time <m>t</m> hours. Let <m>x(t)</m> be the mass of pollutant in the lake at <m>t</m> hours in kg/kL. Mass conservation implies 
					<me>
						\frac{dx}{dt} \text{ kg/h} = (5)(7) \text{ kg/h} - 2 \frac{x}{V} \text{ kg/h},
					</me>
					or
					<me>
						x' + \frac{2x}{3t+1000}  = 35.
					</me>
					This equation readily solved through variation of parameters: 
					<md>
						<mrow> g(t) \amp =\exp\left(\int -\frac{2}{3t+1000}\,dt\right)=(3t+1000)^{-2/3}, </mrow>
						<mrow>k(t) \amp = \int  35(3t+1000)^{2/3} \, dt = 7(3t+1000)^{5/3},  </mrow>
						<mrow> x(t) \amp = c_1(3t+1000)^{-2/3} + 7(3t+1000). </mrow>
					</md>
					The initial condition is that <m>x(0)/V(0)=2</m>, so
					<me>
						2 = \frac{c_1\cdot(1000)^{-2/3} + 7000}{1000}
					</me>,
					which implies <m>c_1=-5(1000)^{5/3}=-5\times 10^5</m>. Thus 
					<me>
						x(t)=7(3t+1000) - \frac{5\times 10^5}{(3t+1000)^{2/3}} \; \text{kg/kL.}
					</me>
					</p>
			</solution>
		</exercise>
		<exercise>
			<title>Cooling coffee</title>
			<statement>
			  <p>
				A mug of coffee at 90 C is put in a room kept at 20 C. After 10 minutes the coffee has cooled by <m>7</m> C. When will the coffee reach 60 C?
			  </p>
			</statement>
			<answer>
			  <p>
				53.1 minutes
			  </p>
			</answer>
			<solution>
			  <p>
				 In terms of the notation above, we have
				<me>
					\frac{dx}{dt} = a (x-20), \quad x(0)=90
				</me>.
				We could also pose it for the temperature difference <m>z=x-20</m> as <m>z'=az</m>. Either way it's a linear problem with solution
				<me>
					x(t) = Ce^{at} + 20
				</me>.
				We have two unknown parameters in the solution, but also two unused pieces of information. We determine <m>C</m> from the initial value:
				<me>
					x(0)= 90 \Rightarrow C=70
				</me>.
				To get a value for <m>a</m>, we use
				<me> 83 = x(7) = 70e^{10a}+20</me>,
				or <m>a=0.1\ln(0.9) \approx -0.01054</m> per min. Hence the coffee will reach 60 C when <m>40 = 70e^{at}</m>, or <m>t\approx 53.1</m> minutes.
			  </p>
			</solution>
		</exercise>	
		<exercise>
			<title>Two mugs of coffee</title>
			<statement>
				<p>
					A more sophisticated model for the cooling of coffee in a well-insulated mug is 
					<me>
						z' = -rSz,
					</me>
					where <m>z(t)</m> is the difference between the coffee temperature and the room temperature, <m>S</m> is the exposed surface area of the coffee, and <m>r</m> is a positive rate constant. Thus, a wider mug that exposes more surface area will cause the coffee to cool faster.
				</p>
				<p>
					Suppose Fred and Wilma each pour out a mug of coffee that is at 85 degrees C. Wilma's mug has a diameter that is <m>\sqrt{2}</m> times as large as Fred's. Both mugs are left sitting out for 30 minutes in a room that is at 25<m>{}^\circ</m> C, at which point Fred's coffee is at 60 degrees. What is the temperature of Wilma's coffee at the same moment?
				</p>
			</statement>
			<answer>
			  <p>
				45.4<m>{}^\circ</m> C
			  </p>
			</answer>
			<solution>
				<p>
					Let's write the IVPs for the two mugs as 
					<md>
					  <mrow>z_F' \amp = -r S_F z_F, \quad z_F(0) = 85-25, </mrow>
					  <mrow> z_W' \amp = -r S_W z_W, \quad z_W(0) = 85-25,</mrow>
					</md>
					in which we also know that <m>S_W=2S_F</m> (because area is proportional to the square of the radius). The solutions are  
					<md>
						<mrow> z_F(t) \amp = 60 \exp(-r S_F t), </mrow>
						<mrow> z_W(t) \amp = 60 \exp(-r 2 S_F t). </mrow>
					</md>
					We are informed that <m>z_F(30) = 60-25=35</m>, and we need to find <m>z_W(30)</m>. But notice that 
					<me>
						60 z_W(t) = 60\cdot 60 \cdot \exp(-r S_F t) \cdot \exp(-r S_F t) = z_F(t)^2. 
					</me>
					Hence <m>z_W(30)=z_F(30)^2/60=35^2/60\approx 20.4</m>, and Wilma's coffee is at <m>45.4^\circ</m> C. 				
				</p>
				<p>
					Note that we don't have enough information to figure out <m>S_F</m> and <m>r</m> separately. We could have solved for their product, which would give us enough information to finish the problem. However, when you find yourself taking a log to get a rate constant and then exponentiating the rate times a different time, it's often possible to skip over the step of finding the rate constant. 
				</p>
			</solution>
		</exercise>
		<exercise>
			<title>Pharmacokinetics</title>
			<statement>
				<p>
					Pharmaceutical companies need to track the concentration of certain drugs throughout the body in order to determine dosage, toxicity, etc.  This is usually done via a compartment model: the body is divided into compartments, and a balance law is formulated in each compartment to account for the transport, consumption and elimination of the drug.  
				</p>
				<p>
					Consider a simple pill of antihistamine taken by a person.  The pill goes to the GI tract where it dissolves and the antihistamine diffuses through to the bloodstream (BS), and it is then eliminated by chemical reactions or through the kidneys. Let <m>x(t)</m>  and <m>y(t)</m> be the concentrations of the drug in the GI tract and the bloodstream, respectively.  Assume the rate of clearance from each compartment is proportional to the drug concentration in that compartment.  Formulate an IVP for the two concentrations.  Assuming the initial concentrations are <m>x(0)=A</m> and <m>y(0)=0</m>, solve the IVPs.
				</p>
			</statement>
			<answer>
			  <p>
				<m>x(t)=A\exp(-k_1 t)</m>, <m>y(t) = \frac{k_1 A}{k_2-k_1} \left( e^{-k_1 t} - e^{-k_2 t} \right)</m>
			  </p>
			</answer>
			<solution>
			  <p>
				Using the given assumptions and mass balances we obtain the system
				<md>
				  <mrow> \frac{dx}{dt} \amp =-k_1 x, \quad x(0)=A,</mrow>
				  <mrow> \frac{dy}{dt} \amp = k_1 x - k_2y, \quad y(0)=0.</mrow>
				</md>
				Although this takes the form of a system of two equations for two dependent variables, we can solve the first one for <m>x</m> independently and then put that result into the second ODE. Specifically, <m>x(t)=A\exp(-k_1 t)</m>, so 
				<me>
					y' + k_2 y = k_1 A e^{-k_1t}.
				</me>
				Let us use undetermined coefficients here. The homogeneous solution is <m>y_h(t)=c_1e^{-k_2 t}</m>, and the particular solution has to take the form <m>y_p(t)=B e^{-k_1 t}</m>. We find the coefficient through placement into the ODE: 
				<me>
					(-k_1B e^{-k_1t}) + k_2 (B e^{-k_1 t}) = k_1 A e^{-k_1t},
				</me>
				which implies <m>B=k_1A/(k_2-k_1)</m>, provided the rate constants are different. (Whatever solution method is chosen would have to deal with that case separately.) Thus 
				<me>
					y(t) = c_1e^{-k_2 t} + \frac{k_1 A}{k_2-k_1} e^{-k_1 t}. 
				</me>
				We find the unknown <m>c_1</m> through the condition 
				<me>
					0 = y(0) = c_1 + \frac{k_1 A}{k_2-k_1},
				</me>
				and finally 
				<me>
					y(t) = \frac{k_1 A}{k_2-k_1} \left( e^{-k_1 t} - e^{-k_2 t} \right).
				</me>
			  </p>
			</solution>
		</exercise>
	</exercises>
	<solutions divisional="solution"></solutions>

</section>

<section xml:id="fl-impulse">
	<title>Steps and impulses</title>
	<introduction>
		<p>
			The following function is very useful in some modeling situations.
		</p>
		<definition xml:id="fl-df-unitstep">
			<title>Unit step function</title>
			<notation><usage>H(t-T)</usage><description>unit step function activated at time <m>T</m></description></notation>
			<statement><p>
				The <idx><h>unit step function</h></idx><term>unit step function</term> or <idx><h>Heaviside function</h><see>unit step function</see></idx><term>Heaviside function</term> <m>H(t)</m> is defined to be zero for <m>t\lt 0</m> and one for <m>t\ge 0</m>.
			</p>
			</statement>
		</definition>
		<p>
			The unit step function represents throwing on an idealized switch. To have the switch turn on at an arbitrary time <m>T</m>, we use <m>H(t-T)</m>. It's worth mentioning here the related idea of a <term>window</term> function, which turns on and then back off. To get a function that is one only between times <m>S</m> and <m>T</m>, for example, we can use <m>H(t-S)-H(t-T)</m>.
		</p>
		<p>
			A key fact to keep in mind about step inputs is:
		</p>
		<fact>
			<p>
				If <m>x(t)</m> solves <m>x'-a(t)x=H(t-T)f(t-T)</m>, where <m>a(t)</m> and <m>f(t)</m> are continuous, then <m>x(t)</m> is continuous.
			</p>
		</fact>
		<p>
			The reason for writing the forcing function as <m>H(t-T)f(t-T)</m> here is that it represents <q>do nothing until time <m>T</m>, then activate <m>f</m> as if starting from time zero</q>. 
		</p>
	</introduction>
	<subsection xml:id="fl-sec-step-solution">
		<title>Solution with piecewise constant forcing</title>
		<p>
			To keep things simple, we will consider problems <m>x'-ax=f(t)</m> in which <m>a</m> is constant and the forcing is piecewise constant, that is,
			<me>
				f(t) = k_1 H(t-T_1) + k_2 H(t-T_2) + \cdots + k_m H(t-T_m)
			</me>. 
			We will exploit the linearity of the problem. Returning to our operator notation <m>\opA[x]=x'-ax</m>, we solve the following problems:
			<md>
			  <mrow>\opA[x_h] \amp= 0, \quad x_h(0)=x_0 , </mrow>
			  <mrow>\opA[x_1] \amp = H(t-T_1),\quad x_1(0)=0, </mrow>
			  <mrow>\amp \vdots </mrow>
			  <mrow>\opA[x_m] \amp = H(t-T_m),\quad  x_m(0)=0. </mrow>
			</md>
			Then we set <m>x(t)=x_h(t)+k_1 x_1(t)+\cdots+k_m x_m(t)</m>. As a result, <m>x(0)=x_0+0+\cdots+0=x_0</m> and 
			<md>
				<mrow> \opA[x] \amp = \opA[x_h] + k_1 \opA[x_1] + \cdots + k_m \opA[x_m] </mrow>
				<mrow>\amp = 0 + k_1[H(t-T_t)] + \cdots + k_m[H(t-T_m)],  </mrow>
			</md>
			which shows that <m>x</m> solves the original IVP. This technique of adding together solutions to linear equations is called <idx>superposition</idx><term>superposition</term>.
		</p>
		<p>
			Really there are only two unique subproblems to solve. The homogeneous part is <m>x_h(t)=e^{a t}x_0</m>. To solve a step problem <m>\opA[x_j]=H(t-T_j)</m> with zero initial condition, we first note that <m>x_j(t)=0</m> for <m>0\le t \le T_j</m>, since there is no forcing over that time interval. Starting at time <m>T_j</m> we have 
			<me>
				\opA[x_j]=1, \quad x_j(T_j)=0
			</me>. 
			This can be solved easily using undetermined coefficients with a constant particular solution. The result is <m>x_j(t)=(e^{a (t-T_j)} - 1)/a</m> for <m>t \gt T_j</m>. Putting both time intervals together, we get 
			<me>
				x_j(t) = \frac{1}{a} H(t-T_j) (e^{a(t-T_j)} - 1)
			</me>. 
			We now have  everything we need.	
		</p>
		<!--men xml:id="fl-eq-step_ivp">
			\opA[x] = x' - a(t) x = H(t-T)f(t-T), \quad x(0)=x_0,
		</men>
		we will exploit the linearity of the problem at a root level. That is, suppose <m>x_h</m> solves 
		<men xml:id="fl-eq-step_h">
			x' - a(t) x = 0, \quad x(0)=x_0,
		</men>
		and that <m>x_s</m> solves 
		<men xml:id="fl-eq-step_p">
			x' - a(t+T) x = f(t), \quad x(0)=0.
		</men>
		Now define <m>\tilde{x}_s(t) = H(t-T)x_s(t-T)</m>. For <m>t \lt T</m>, this function is identically zero. For <m>t \gt T</m>, we have 
		<md>
			<mrow> \frac{d}{dt} \tilde{x}_s(t)  \amp = \frac{d}{dt} x_s(t-T) = x_s'(t-T) \cdot 1</mrow>
			<mrow>\amp = a(t+T-T) x_s(t-T) + f(t-T) </mrow>
			<mrow>  \amp = a(t) \tilde{x}_s(t) + f(t-T).</mrow>
		</md>
		If we combine the two time intervals, we have proven that <m>\tilde{x}_s</m> solves <m>\opA[x]=H(t-T)f(t-T)</m>. Finally, let <m>x(t)=x_h(t)+\tilde{x}_s(t)</m>. Then <m>x(0)=x_h(0)+\tilde{x}_s(0)=x_0+0</m>, and 
		<me>
			\opA[x] = \opA[x_h] + \opA[\tilde{x}_s] = 0 + H(t-T)f(t-T)
		</me>. 
		Hence <m>x</m> is the solution of <xref ref="fl-eq-step_ivp"/>. 	
	</p>
	<p>
		That derivation may have seemed complicated, but the conclusion is not. To simplify it we will restate it for the special case in which the functions in the ODE are all constants. Thus, to solve 
		<me>
			\opA[x] = x' - a x = H(t-T), \quad x(0)=x_0
		</me>,
		we first solve <m>x' - a x = 0</m> with <m>x(0)=x_0</m> to get 
		<me>
			x_h(t) = e^{a t} x_0
		</me>. 
		Then we solve <m>x' - a x = 1</m> with <m>x(0)=0</m> to get 
		<me>
			x_s(t) = e^{a t} - 1
		</me>. 
		Then the solution to the original IVP is 
		<me>
			x(t) = x_h(t) + H(t-T)x_s(t-T) = e^{a t} x_0 + H(t-T)(e^{a(t-T)}-1)
		</me>. 
		This technique of adding together solutions to linear equations is called <idx>superposition</idx><term>superposition</term>. It nicely extends to having multiple step functions that define a piecewise constant forcing. For example, to solve 
		<me>
			x'- a x  = k_1 H(t-T_1) + k_2 H(t-T_2), \quad x(0)=x_0
		</me>,
		we would use 
		<me>
			x(t)=x_h(t) + k_1 H(t-T_1)x_s(t-T_1) + k_2 H(t-T_2)x_s(t-T_2)
		</me>, 
		and so on. 
	</p-->
		<example xml:id="fl-ex-stepforce">
			<p>
				Let's solve <m>x'-\frac{1}{10}x=w(t)</m>, <m>x(0)=-2</m>, where <m>w(t)</m> is a window function that is 5 for <m>3 \lt t \le 6</m> and zero elsewhere. We can write the problem as 
				<me>
					x' - \frac{1}{10}x = 5[H(t-3) - H(t-6)] = 5H(t-3) - 5H(t-6), \quad x(0)=-2
				</me>. 
				The solution therefore consists of three terms: 
				<me>
					x(t) = -2 e^{t/10} + 50 H(t-3) (e^{(t-3)/10}-1) - 50 H(t-6)(e^{(t-6)/10}-1)
				</me>. 
				The first term is the homogeneous (or free) response, and the others switch on as the forcing changes its value. A piecewise expression of the solution is 
				<me>
					x(t) = \begin{cases} 
					-2e^{t/10}, \amp 0 \le t \lt 3, \\ 
					-2e^{t/10} + 50(e^{(t-3)/10}-1), \amp 3 \le \lt 5, \\ 
					-2e^{t/10} + 50(e^{(t-3)/10}-e^{(t-6)/10}), \amp 5 \le t
					\end{cases}
				</me>.
			</p>
			<sidebyside>
				<listing xml:id="fo_lcc_window">
					<caption>Numerical solution with step forcing (1st order).</caption>
					<program language="matlab">
						<input>
							step = @(t) double(t>0);
							dxdt = @(t,x) 0.1*x + 5*(step(t-3) - step(t-6));
							[t,x] = ode45(dxdt,[0,8],-2);
							plot(t,x)
							xlabel('t'), ylabel('x(t)')
							title('Window forcing')
						</input>
					</program>
				</listing>
				<image source="figures/fo_lcc_window.svg"/>
			</sidebyside>
		</example>
	</subsection>
	<subsection xml:id="fl-sec-impulse-forcing">
		<title>Impulse forcing</title>
		<p>
			Next imagine that we use a window function as the forcing term over ever shortening times, but in such a way that the integral under the curve remains constant. It's analogous to delivering a dose of medication via a slow IV drip versus injecting the same dose all at once directly. Define
			<me>
				\delta_\epsilon(t) = \frac{1-H(t-\epsilon)}{\epsilon}
			</me>.
			The area under the <m>\delta_\epsilon(t)</m> curve equals one for all <m>\epsilon \gt 0</m>. We now ask what happens as the window width <m>\epsilon</m> approaches zero.
		</p>
		<definition xml:id="fl-def-impresp">
			<title>Impulse response</title>
			<statement><p>
				The <idx>impulse response</idx><term>impulse response</term> of the linear operator <m>\mathcal{A}[x]=x'-ax</m> is the limit as <m>\epsilon\to 0</m> of the solution to <m>\mathcal{A}[x]=\delta_\epsilon(t)</m> with <m>x(0)=0</m>.
			</p></statement>
		</definition>
		<p>
			We often write the impulse response as the solution of <m>x'-ax=\delta(t)</m>, where <m>\delta(t)</m> is an <idx>impulse</idx><term>impulse</term> or a <term>delta function</term>. <notation><usage>\delta(t)</usage><description>impulse forcing</description></notation> (A math pedant will never fail to remind you that <m>\delta(t)</m> isn't actually a function. Let's not go there.)
		</p>
		<p>
			The solution to <m>x'-ax=\delta_\epsilon(t)</m>, <m>x(0)=0</m> is easily found for a constant <m>a</m> using the method described above, resulting in
			<me>
				x_\epsilon(t) = \frac{1}{a \epsilon} \left[  (e^{at}-1) - H(t-\epsilon) (e^{a(t-\epsilon)}-1) \right]
			</me>. 
			As <m>\epsilon\to 0</m>, we only care about what happens for <m>t\gt \epsilon</m>, which gives 
			<me>
				x_\epsilon(t) = \frac{e^{a t}}{a \epsilon}  \left( 1 - e^{-a\epsilon} \right), \quad t \gt \epsilon
			</me>. 
			Using L'Hôpital's Rule,
			<me>
				\lim_{\epsilon\to 0} x_\epsilon(t) =e^{at} \left[ \lim_{\epsilon\to 0}  \frac{1 - e^{-a\epsilon}}{a \epsilon}\right] = e^{at}, \quad t \gt 0
			</me>.
			Hence the constant-coefficient impulse response is simply <m>e^{at}</m>. This is the same as the solution of the homogeneous <m>x'-ax=0</m> with initial value one rather than zero. This remarkable observation generalizes as follows.
		</p>
		<fact>
			<p>
				The solution of <m>x'-a(t)x=f(t) + k \delta(t-T)</m>, <m>x(0)=x_0</m>, where <m>a(t)</m> and <m>f(t)</m> are continuous, satisfies
				<me>
					x'-a(t)x=f(t), \; x(0)=x_0
				</me>
				for <m>t\lt T</m>, and
				<me>
					x'-a(t)x=f(t), \; x(T)=x(T^-)+k
				</me>
				for <m>t\gt T</m>, where <m>x(T^-)=\lim_{t\to T^-} x(t)</m> comes from the first stage of the solution. If <m>T=0</m>, then
				<me>
					x'-a(t)x=f(t), \; x(0)=x_0+k
				</me>
				for <m>t\gt 0</m>.
			</p>
		</fact>
		<p>
			In words, <alert>an impulse in a first-order linear equation is equivalent to an instantaneous jump in the value of the solution</alert>. As before, it's easy to use superposition to get a solution for the case of constant coefficients, 
			<me> 
				x' - ax = k \delta(t-T), \quad x(0)=x_0
			</me>. 
			The homogeneous part is, as before, <m>x_h(t)=e^{a t}x_0</m>. The forced response is the solution of 
			<me> 
				x' - ax = \delta(t-T), \quad x(0)=0
			</me>,
			which, similarly to the derivation above, is <m>x_d(t)=H(t-T) e^{a (t-T)}</m>. Then the complete solution is the superposition 
			<me>
				x_h(t) +  k x_d(t) = e^{a t}x_0 + k H(t-T)e^{a (t-T)}
			</me>. 
			This technique extends naturally to multiple impulses of different amplitudes--in fact, to any linear combination of steps and impulses. 
		</p>
		<example>
			<p>
				To solve <m>x'+5x=3\delta(t-2)</m>, with <m>x(0)=1</m>, we combine 
				<me>
					x(t) = x_h(t) + 3H(t-2)x_d(t-2) = e^{-5 t} + 3H(t-2)e^{-5(t-2)}
				</me>.
			</p>
			<sidebyside>
				<listing xml:id="fo_lcc_impulse">
				<caption>Numerical solution with impulse forcing (1st order).</caption>
				<program language="matlab">
					<input>
					dxdt = @(t,x) -5*x;
					[t1,x1] = ode45(dxdt,[0,2],1);
					[t2,x2] = ode45(dxdt,[2,5],3+x1(end));
					semilogy([t1;t2],[x1;x2])
					xlabel('t'), ylabel('x(t)')
					title('Impulse forcing')
					</input>
				</program>
				</listing>
			<image source="figures/fo_lcc_impulse.svg"/>
			</sidebyside>
		</example>
	</subsection>

	<exercises xml:id="fl-exer-discont">
		<title>Practice for step and impulse forcing</title>
		<exercisegroup>
			<introduction>
				<p>
					There are many different ways to deliver a drug to a person's bloodstream. For instance, we could use a single dose or multiple smaller doses. In first-order pharmacokinetics we assume that in the absence of an external input, the concentration of a drug in the bloodstream is cleared exponentially like <m>x'=-r x</m> for a rate constant <m>r</m>. We will also model an intravenous drip as a  piecewise constant forcing function.
				</p>
			</introduction>
			<exercise>
				<title>One dose</title>
				<statement>
					<p>
						Suppose the initial serum drug concentration <m>x(t)</m> is initially zero when an IV is given at a constant rate of 12 units per hour for 30 minutes. An IVP that models this case is 
						<me>
							x'=-r x + 12 \left[ 1-H(t-0.5) \right], \quad x(0)=0,
						</me>
						where <m>t</m> is measured in hours. Solve it to find the concentration of the drug over time.
					</p>
				</statement>
				<answer>
				  <p>
					<m>\frac{12}{r}\left[ 1-e^{-r t} - H(t-0.5)\bigl(1-e^{-r(t-0.5)} \bigr)\right]</m>
				  </p>
				</answer>
				<solution>
				  <p>
					We use the window function <m>1-H(t-0.5)</m> to represent the time interval of the IV drip. So the appropriate IVP (in time units of hours) is
					Recall that for the solution times <m>t>0</m>, <m>H(t)</m> is just the constant 1. We can solve this IVP using three pieces. The unforced part with the initial condition is <m>x_h(t)=0</m>, so it contributes nothing. The other two are due to the steps: 
					<md>
					  <mrow>x_1(t) \amp = \frac{1}{-r} H(t-0) \bigl(e^{-r(t-0)} - 1\bigr) = \frac{1}{r} \bigl(1- e^{-r t}\bigr), </mrow>
					  <mrow> x_2(t) \amp = \frac{1}{r} H(t-0.5) \bigl(1 - e^{-r(t-0.5)}\bigr). </mrow>
					</md>
					Hence we arrive at 
					<me>
						x(t) = 12x_1(t) - 12 x_2(t) = \frac{12}{r}\left[ 1-e^{-r t} - H(t-0.5)\bigl(1-e^{-r(t-0.5)} \bigr)\right]
					</me>. 								
				  </p>
				</solution>
			</exercise>
			<exercise>
				<title>Four doses</title>
				<statement>
				  <p>
					If the drug is given in four doses, each given at 3 units per hour over five minutes and separated by six hours, the model becomes  
					<me>
						x' + r x = 3 \sum_{n=0}^3 \left[H(t-6n)-H\Bigl(t-6n-\tfrac{1}{12}\Bigr)\right].
					</me>
					Solve it for <m>x(t)</m>.
			  </p>
				</statement>
				<answer>
				  <p>
					<me>
						\frac{3}{r} \sum_{n=0}^3 H(t-6n) \Bigl(1 - e^{-r(t-6n)}\Bigr) - 
							H\bigl(t-6n-\tfrac{1}{12}\bigr) \Bigl(1 - \exp\bigl(-r(t-6n-\tfrac{1}{12})\bigr) \Bigr)
					</me>
				  </p>
				</answer>
				<solution>
					<p>
						In total the forcing function has eight terms, which we can group into four pairs. These lead to the solution parts 
						<me>
							x_n(t) = \frac{1}{r} H(t-6n) \Bigl(1 - e^{-r(t-6n)}\Bigr) - 
							\frac{1}{r} H\bigl(t-6n-\tfrac{1}{12}\bigr) \Bigl(1 - \exp\bigl(-r(t-6n-\tfrac{1}{12})\bigr) \Bigr)
						</me>
						The homogeneous part of the solution is again zero, so the total solution is <m>x(t)=3\sum_{n=0}^3 x_n(t)</m>.
					</p>
				</solution>
			</exercise>
		</exercisegroup>
		<exercisegroup>
			<introduction>
				<p>
					An alternative to an IV drip is an injection. This takes so short a time that we may as well model it as an impulse. 
				</p>
			</introduction>
			<exercise>
				<title>One injection</title>
				<statement>
				  <p>
					Starting from an initial drug-free state, suppose we deliver an injection of 6 units. The model is now 
					<me>
						x'+r x = 6\delta(t), \quad x(0)=0.
					</me>
					What is the resulting <m>x(t)</m>?
				  </p>
				</statement>
				<answer>
				  <p>
					<m>6e^{-r t}</m>
				  </p>
				</answer>
				<solution>
				  <p>
					The model IVP is equivalent to <m>x'+r x = 0</m> with <m>x(0)=6</m>, whose solution is <m>x(t) = 6e^{-r t}</m>.
				  </p>
				</solution>
			</exercise>
			<exercise>
				<title>Four injections</title>
				<statement>
				  <p>
					If we deliver four injections every 6 hours, each with 3 units of the drug, the model becomes 
					<me>
						x' + r x = 3 \sum_{n=0}^3 \delta(t-6n), \quad x(0)=0.
					</me>
					Solve it for <m>x(t)</m>.
				  </p>
				</statement>
				<answer>
				  <p>
					<me>3\sum_{n=0}^3 H(t-6n) e^{-r (t-6n)}</me>
				  </p>
				</answer>
				<solution>
				  <p>
					We can apply the machinery from this section. With a zero initial value, the homogeneous part of the solution is identically zero. Using delayed impulse responses, term <m>n</m> from the sum leads to 
					<me>
						x_n(t) = H(t-6n) e^{-r (t-6n)}.
					</me>
					Hence the total solution is 
					<me>
						x(t) = 3\sum_{n=0}^3 H(t-6n) e^{-r (t-6n)}.
					</me>
				  </p>
				</solution>
			</exercise>			
		</exercisegroup>
	</exercises>
	<solutions divisional="solution"/>

</section>

<section xml:id="fl-laplace">
	<title>Laplace transform methods</title>
	<introduction>
	<p>
		There is a shorthand method for deriving the solutions of linear, constant-coefficient equations that have forcing functions such as steps, impulses, and elementary functions. Given (almost) any function <m>f(t)</m>, there is a doppelganger function <m>F(s)</m> defined by an integral.
		<notation>
			<usage>\lx[f(t)]</usage>
			<description>Laplace transform of a function</description>
		</notation>  
	</p>
	<definition xml:id="fl-df-laplace">
		<title>Laplace transform</title>
		<statement><p>
			The <idx>Laplace transform</idx><term>Laplace transform</term> of a function <m>f(t)</m> is defined as
			<men xml:id="so-lap-lxform">
				\lx[f(t)] = F(s) = \int_0^\infty f(t) e^{-st}\, dt
			</men>.
		</p></statement>
	</definition>
	<p>
		In this business, time starts at <m>t=0</m>, and any reference to <m>f(t)</m> for negative <m>t</m> is defined to be zero. A convention is that a lowercase function of <m>t</m> transforms to its uppercase namesake as a function of <m>s</m>. (Another convention is that <m>\lx</m> is used with curly braces, but we have already committed to using square brackets for operators.)
	</p>
	<fact>
		<p>
			The Laplace transform is a linear operator. That is,
			<md>
				<mrow>\lx[ f(t) + g(t) ] = F(s) + G(s) </mrow>
				<mrow>\lx[ c f(t) ] = c F(s)</mrow>
			</md>,
			where <m>c</m> is any constant.
		</p>
	</fact>
	</introduction>

	<subsection>
		<title>Derivatives</title>
		<p>
			Applying integration by parts to the definition of <m>\lx[x'(t)]</m> reveals the main reason Laplace transforms are useful in ODEs:
			<md>
				<mrow>\lx[x'(t)] \amp = \int_0^\infty x'(t) e^{-st}\, dt </mrow>
				<mrow>\amp = \left[ x(t)e^{-st}\right]_0^\infty - \int_0^\infty (-s) x(t) e^{-st}\, dt </mrow>
				<mrow>\amp = -x(0) + s X(s)</mrow>
			</md>.
			<alert>Calculus is turned into algebra by the Laplace transform.</alert> So here is the plan of attack. Given an ODE <m>x'-ax=f(t)</m>, we transform everything in sight to get
			<me>
				sX(s)-x(0) - a X(s) =  F(s)
			</me>.
			Now solve for the transform of the solution:
			<me>
				X(s) = \frac{ F(s) + x(0)}{s-a}
			</me>.
			Now <q>all</q> we have to do know is to compute the inverse transform, that is, find <m>x(t)</m> given <m>X(s)</m>. This is a lot less straightforward than computing the forward transform, unfortunately. But we can make it manageable in much the same way you learned indefinite integration: by learning some canonical cases and then matching patterns.
		</p>
	</subsection>

	<subsection>
		<title>Basic transforms</title>
		<p>
			We can find the transform of an exponential function from the transform definition. For any real number <m>c</m>,
			<me>
				\lx[e^{c t}] = \int_0^\infty e^{(c-s)t}\, dt = \left[ -\frac{1}{s-c} e^{(c-s)t} \right]_0^\infty = \frac{1}{s-c}
			</me>.
			(To make this valid requires that <m>c\lt s</m>, but we are going to ignore all such technicalities.)
		</p>
		<fact>
			<title>Transform of an exponential</title>
			<p>
				<men xml:id="fl-eq-ltexp">
					\lx[e^{c t}] = \frac{1}{s-c}
				</men>.
				An important special case is <m>c=0</m>:
				<me>
					\lx[1]=\frac{1}{s}
				</me>.
			</p>
		</fact>
			<example>
			<p>
				Let's consider <m>x'-ax=e^{ct}</m>, where <m>a,c</m> are different constants. Transforming both sides, we get
				<me>
					[sX(s)-x(0)] - aX(s) =\frac{1}{s-c}
				</me>,
				and thus
				<me>
					X(s) = \frac{x(0)}{s-a} + \frac{1}{(s-c)(s-a)}
				</me>.
				We can immediately recognize the first term as the transform of <m>e^{at}x(0)</m>. To invert the transform of the second term, we need to express it using partial fractions. There is a general procedure for this, but it's worth knowing a simple mnemonic for this particular form:
				<me>
					\frac{1}{(s-c)(s-a)} = \frac{1}{(a-c)(s-a)} + \frac{1}{(s-c)(c-a)}
				</me>.
				Thus the inverse transform of this fraction is a sum of two exponentials,
				<me>
					x_p(t) = \frac{1}{c-a}\left( e^{ct}-e^{at} \right)
				</me>.
				This is a particular solution that has <m>x_p(0)=0</m>. The general solution is <m>e^{at}x(0) + x_p(t)</m>.
			</p>
		</example>

		<p>
			Finding the transform of a step is also pretty easy:
			<md>
				<mrow>\lx[H(t-T)] \amp = \int_T^\infty e^{-st}\, dt </mrow>
				<mrow>\amp = -\frac{1}{s} \Bigl[ e^{-st} \Bigr]_T^\infty = \frac{e^{-sT}}{s} </mrow>
			</md>.
		</p>
		<fact>
			<title>Transform of a step</title>
			<p>
				<men xml:id="fl-eq-ltstep">
					\lx[H(t-T)] = \frac{e^{-sT}}{s}
				</men>.
			</p>
		</fact>
		<p>
			A generalization of the same calculation results in a very important rule.
		</p>
		<theorem xml:id="fl-thm-shift">
			<title>Shift theorem</title>
			<statement><p>
				<men xml:id="fl-eq-ltshift">
					\lx[H(t-T)f(t-T)] = e^{-sT} \lx[f(t)]
				</men>.
			</p></statement>
		</theorem>
		<p>
			To get the transform of an impulse, we can play the same game as before. The transform of our narrow step <m>\delta_\epsilon</m>  is
			<me>
				\lx[ \delta_\epsilon(t-T)] = \frac{1}{\epsilon} \left( \lx[H(t-T)] - \lx[H(t-T-\epsilon) \right) = \frac{1 - e^{\epsilon s}}{\epsilon s}e^{-sT}
			</me>.
			Taking the limit as <m>\epsilon\to 0</m> gives the following.
		</p>
		<fact>
			<title>Transform of an impulse</title>
			<p>
				<men xml:id="fl-eq-ltimpulse">
					\lx[\delta(t-T)] = e^{-sT}
				</men>.
				An important special case is <m>T=0</m>:
				<me>
					\lx[\delta(t)] = 1
				</me>.
			</p>
		</fact>

		<example>
			<p>
				Let's consider <m>x'=ax + \delta(t-T)</m>, with <m>x(0)=0</m>. Transform to get
				<me>
					[sX(s)-x(0)] - aX(s) = e^{-sT}
				</me>,
				and thus
				<me>
					X(s) = \frac{e^{-sT}}{s-a}
				</me>.
				Notice that <m>X(s) = e^{-sT} Y(s)</m>, where <m>Y(s)=1/(s-a)</m> is the transform of <m>y(t)=e^{at}</m>. By the shift theorem, it must be that
				<me>
					x(t) = H(t-T)y(t-T) = H(t-T)e^{a(t-T)}
				</me>.
			</p>
		</example>
		<p>
			<xref ref="fl-tab-laplace"/> summarizes the transform formulas we have learned so far. When faced with finding an inverse transform, the game is to manipulate the expression algebraically until it can be matched with one or more lines in the right column.
		</p>
			<table xml:id="fl-tab-laplace">
			<title>Laplace transforms (basic)</title>
			<tabular>
				<row>
					<cell>Function</cell>
					<cell>Transform</cell>
				</row>
			<row>
				<cell><m>x'(t)</m></cell>
				<cell><m>sX(s)-x(0)</m></cell>
			</row>
			<row>
				<cell>1</cell>
				<cell><m>\dfrac{1}{s}</m></cell>
			</row>
			<row>
				<cell><m>e^{at}</m></cell>
				<cell><m>\dfrac{1}{s-a}</m></cell>
			</row>
			<row>
				<cell><m>e^{at}</m></cell>
				<cell><m>\dfrac{1}{s-a}</m></cell>
			</row>
			<row>
				<cell><m>H(t-T)</m></cell>
				<cell><m>\dfrac{e^{-sT}}{s}</m></cell>
			</row>
			<row>
				<cell><m>H(t-T)f(t-T)</m></cell>
				<cell><m>e^{-sT}F(s)</m> (shift theorem)</cell>
			</row>
			<row>
				<cell><m>\delta(t-T)</m></cell>
				<cell><m>e^{-sT}</m></cell>
			</row>
			</tabular>
		</table>
	</subsection>

	<subsection>
		<title>Transfer function</title>
		<p>
			Perhaps it's clear by now that <m>x'-ax=f(t)</m> always leads to <m>X(s) = F(s)/(s-a)</m> as a particular solution. The term <m>1/(s-a)</m> is called the <idx>transfer function</idx><term>transfer function</term> of the ODE. Values of <m>s</m> that are roots of the denominator are known as <term>poles</term> of the transform. They point out exponential solutions.
		</p>
		<p>
			The impulse response is the case when <m>f(t)=\delta(t)</m>, so that <m>F(s)=1</m>. This implies the following.
		</p>
		<fact>
			<statement>
				<p>
					The transfer function is the Laplace transform of the impulse response.
				</p>
			</statement>
		</fact>
	</subsection>

	<exercises xml:id="fl-exer-laplace">
		<title>Practice for Laplace transforms</title>
		<exercise>
			<title>Linear function</title>
			<statement>
			  <p>
				Use the definition of the Laplace transform to find <m>\lx[t]</m>. (As usual, assume that <m>s</m> is constrained in any way needed to make the integral converge.)
			  </p>
			</statement>
			<answer>
			  <p>
				<me>
					\frac{1}{s^2}
				</me>			
			  </p>
			</answer>
			<solution>
				<p>
				  Using integration by parts, 
					<md>
				  		<mrow>\lx[t] \amp = \int_0^\infty t e^{-s t}\, dt  </mrow>
						<mrow>  \amp = \left[ -\frac{t e^{-s t}}{s} \right]_{t=0}^\infty + \frac{1}{s} \int_0^\infty e^{-s t}\, dt  </mrow>
						<mrow>  \amp = [0 - 0] + \frac{1}{s} \lx[1] </mrow>
						<mrow>  \amp = \frac{1}{s^2}.</mrow>
					</md>
				</p>
			</solution>
		</exercise>
		<exercise>
			<title>Second derivative</title>
			<statement>
				<p>
					Find the Laplace transform of the second derivative of a function: <m>\lx[x''(t)]</m>. 
				</p>
			</statement>
			<hint>
			  <p>
				It's possible to do this by applying the integral definition of the Laplace transform. However, it's a lot easier to do by twice applying the known transform formula of the first derivative. 
			  </p>
			</hint>
			<answer>
				<p>
				  <m>\lx[x''(t)] = s^2X(s) - s x(0) - x'(0)</m>
				</p>
			</answer>  
			<solution>
			  <p>
				Suppose we let <m>u(t)=x'(t)</m>. Then 
				<me>
					\lx[x''(t)] = \lx[u'(t)] = sU(s) - u(0).
				</me>
				Also 
				<me>
					U(s) = \lx[u(t)] = \lx[x'(t)] = sX(s) - x(0). 
				</me>
				Thus 
				<me>
					\lx[x''(t)] = s[sX(s)-x(0)] - u(0) = s^2X(s) - s x(0) - x'(0). 
				</me>
			  </p>
			</solution>
		</exercise>
		<exercise>
			<title>Hyperbolic sine</title>
			<statement>
			  <p>
				Find the Laplace transform of the function <m>\sinh(t)</m>.
			  </p>
			</statement>
			<hint>
			  <p>
				<me>\sinh(t)=\frac{1}{2}(e^t-e^{-t})</me>
			  </p>
			</hint>
			<answer><p> <me>\frac{1}{s^2-1}</me> </p> </answer>
			<solution>
			  <p>
				  <md>
					<mrow>\lx\left[ \tfrac{1}{2}\bigl( e^t - e^{-t} \bigr) \right]  \amp = \frac{1}{2} \left( \lx[e^t] - \lx[e^{-t}] \right) </mrow>
					<mrow>  \amp = \frac{1}{2} \left( \frac{1}{s-1} - \frac{1}{s+1} \right) </mrow>
					<mrow>  \amp = \frac{1}{s^2-1}.</mrow>
				  </md>
			  </p>
			</solution>
		</exercise>
		<exercise>
			<title>Multiplying by an exponential</title>
			<statement>
			<p>
				Suppose as usual that <m>\lx[f(t)]=F(s)</m>. Use the integral definition of the Laplace transform to find a simple expression for <m>\lx[e^{at} f(t)]</m> in terms of <m>F</m>.
			</p>
			</statement>
			<answer>
			  <p>
				<m>F(s-a)</m>
			  </p>
			</answer>
			<solution>
			  <p>
				  It takes two applications of the transform definition to get a simple and useful fact:
				  <md>
					<mrow>\lx[e^{at} f(t)] \amp = \int_0^\infty e^{at} f(t) e^{-st} \, dt</mrow>
					<mrow>  \amp = \int_0^\infty f(t) e^{-(s-a)t} \, dt  </mrow>
					<mrow>  \amp = F(s-a)</mrow>
				</md>
			  </p>
			</solution>
		</exercise>
		</exercises>
	<solutions divisional="solution"></solutions>

</section>

</chapter>
