<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2020-01-27T16:53:04-05:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Undetermined coefficients</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script>(function() {
  var cx = '001745383498963294448:kueq4ektvbo';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
</script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.12/pretext.js"></script><script src="https://pretextbook.org/js/0.12/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/style_default.css" rel="stylesheet" type="text/css">
<link href="colors_delaware.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/setcolors.css" rel="stylesheet" type="text/css">
<!-- 2019-10-12: Temporary - CSS file for experiments with styling --><link href="developer.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/features.css" rel="stylesheet" type="text/css">
<script>var logged_in = false;
var role = 'student';
var guest_access = true;
var login_required = false;
var js_version = 0.12;
</script>
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\newcommand{\dd}[2]{\frac{d #1}{d #2}}
\renewcommand{\Re}{\text{Re}}
\renewcommand{\Im}{\text{Im}}
\newcommand{\spr}[1]{^{(#1)}}
\newcommand{\dd}[2]{\frac{d #1}{d #2}}
\newcommand{\ddd}[2]{\frac{d^2 #1}{d #2^2}}
\newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\ppp}[2]{\frac{\partial^2 #1}{\partial #2^2}}
\newcommand{\norm}[1]{\left\| #1 \right\|}
\newcommand{\det}{\operatorname{det}}
\newcommand{\null}{\operatorname{null}}
\newcommand{\span}{\operatorname{span}}
\newcommand{\bzero}{\boldsymbol{0}}
\newcommand{\Rn}[1]{\mathbb{R}^{#1}}
\newcommand{\Cn}[1]{\mathbb{C}^{#1}}
\newcommand{\Rmn}[2]{\mathbb{R}^{#1\times #2}}
\newcommand{\Cmn}[2]{\mathbb{C}^{#1\times #2}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\opA}{\mathcal{A}}
\newcommand{\lx}{\mathcal{L}}
\newcommand{\bA}{\mathbf{A}}
\newcommand{\bB}{\mathbf{B}}
\newcommand{\bC}{\mathbf{C}}
\newcommand{\bD}{\mathbf{D}}
\newcommand{\bI}{\mathbf{I}}
\newcommand{\bJ}{\mathbf{J}}
\newcommand{\bV}{\mathbf{V}}
\newcommand{\bX}{\mathbf{X}}
\newcommand{\bY}{\mathbf{Y}}
\newcommand{\bff}{\mathbf{f}}
\newcommand{\ba}{\mathbf{a}}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\by}{\mathbf{y}}
\newcommand{\bb}{\mathbf{b}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\bw}{\mathbf{w}}
\newcommand{\bc}{\mathbf{c}}
\newcommand{\bz}{\mathbf{z}}
\newcommand{\inprod}[2]{\langle #1, #2 \rangle}
\newcommand{\twovec}[2]{\begin{bmatrix}#1\\#2\end{bmatrix}}
\newcommand{\threevec}[3]{\begin{bmatrix}#1\\#2\\#3\end{bmatrix}}
\newcommand{\twodet}[4]{\begin{vmatrix}#1 \amp #2\\#3 \amp #4\end{vmatrix}}
\newcommand{\twomat}[4]{\begin{bmatrix}#1 \amp #2\\#3 \amp #4\end{bmatrix}}
\newcommand{\twodiag}[2]{\begin{bmatrix} #1 \amp 0 \\ 0 \amp #2 \end{bmatrix}}
\newcommand{\fourdiag}[3]{\begin{bmatrix} #1 \amp  \amp \amp  \\                    \amp #2 \amp  \amp  \\  \amp \amp \ddots \amp \\  \amp  \amp  \amp #3 \end{bmatrix}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="notes.html"><span class="title">Notes for MATH 305</span></a></h1>
<p class="byline">Toby Driscoll</p>
</div>
<div class="searchwrapper" role="search"><div class="gcse-search"></div></div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3">
<a class="index-button toolbar-item button" href="index-1.html" title="Index">Index</a><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="fl-varparam.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="first-order-linear.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="first-order-models.html" title="Next">Next</a></span>
</div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="fl-varparam.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="first-order-linear.html" title="Up">Up</a><a class="next-button button toolbar-item" href="first-order-models.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link">
<a href="frontmatter.html" data-scroll="frontmatter"><span class="title">Front Matter</span></a><ul><li><a href="preface-1.html" data-scroll="preface-1">Preface</a></li></ul>
</li>
<li class="link">
<a href="linear-algebra.html" data-scroll="linear-algebra"><span class="codenumber">1</span> <span class="title">Linear algebra</span></a><ul>
<li><a href="la-linear-systems.html" data-scroll="la-linear-systems">Linear systems of equations</a></li>
<li><a href="la-elimination.html" data-scroll="la-elimination">Row elimination</a></li>
<li><a href="la-vector-algebra.html" data-scroll="la-vector-algebra">Vector algebra</a></li>
<li><a href="la-matrix-algebra.html" data-scroll="la-matrix-algebra">Matrix algebra</a></li>
<li><a href="la-general-solution.html" data-scroll="la-general-solution">General and particular solutions</a></li>
<li><a href="la-basis.html" data-scroll="la-basis">Basis and dimension</a></li>
<li><a href="la-determinant.html" data-scroll="la-determinant">Determinants</a></li>
<li><a href="la-inverse.html" data-scroll="la-inverse">Inverses</a></li>
<li><a href="la-equivalent.html" data-scroll="la-equivalent">Equivalent conditions</a></li>
<li><a href="la-complex.html" data-scroll="la-complex">Complex numbers</a></li>
<li><a href="la-eigen.html" data-scroll="la-eigen">Eigenvalues</a></li>
</ul>
</li>
<li class="link">
<a href="first-order-linear.html" data-scroll="first-order-linear"><span class="codenumber">2</span> <span class="title">First-order linear ODEs</span></a><ul>
<li><a href="linearity.html" data-scroll="linearity">Introduction</a></li>
<li><a href="first-linear-ode.html" data-scroll="first-linear-ode">Linear ODEs</a></li>
<li><a href="fl-homogeneous.html" data-scroll="fl-homogeneous">Homogeneous solutions</a></li>
<li><a href="fl-ivp.html" data-scroll="fl-ivp">Initial value problems</a></li>
<li><a href="fl-varparam.html" data-scroll="fl-varparam">Variation of parameters</a></li>
<li><a href="fl-undeter.html" data-scroll="fl-undeter" class="active">Undetermined coefficients</a></li>
<li><a href="first-order-models.html" data-scroll="first-order-models">Modeling with first-order ODEs</a></li>
<li><a href="fl-impulse.html" data-scroll="fl-impulse">Steps and impulses</a></li>
<li><a href="fl-laplace.html" data-scroll="fl-laplace">Laplace transform methods</a></li>
</ul>
</li>
<li class="link">
<a href="first-systems.html" data-scroll="first-systems"><span class="codenumber">3</span> <span class="title">First-order linear systems</span></a><ul>
<li><a href="fs-structure.html" data-scroll="fs-structure">Structure of linear ODE systems</a></li>
<li><a href="fs-homogeneous.html" data-scroll="fs-homogeneous">Homogeneous systems</a></li>
<li><a href="fs-constcoeff.html" data-scroll="fs-constcoeff">Constant-coefficient systems</a></li>
<li><a href="fs-complex-exponentials.html" data-scroll="fs-complex-exponentials">Complex exponentials</a></li>
<li><a href="fs-phaseplane.html" data-scroll="fs-phaseplane">Phase plane</a></li>
<li><a href="fs-matrix-exp.html" data-scroll="fs-matrix-exp">Matrix exponential</a></li>
<li><a href="fs-varparam.html" data-scroll="fs-varparam">Variation of parameters</a></li>
</ul>
</li>
<li class="link">
<a href="first-order-linear.html" data-scroll="first-order-linear"><span class="codenumber">4</span> <span class="title">Second-order ODEs</span></a><ul>
<li><a href="so-convert.html" data-scroll="so-convert">Order equals dimension</a></li>
<li><a href="so-homogeneous.html" data-scroll="so-homogeneous">Homogeneous problem</a></li>
<li><a href="so-oscillators.html" data-scroll="so-oscillators">Oscillators</a></li>
<li><a href="so-expforcing.html" data-scroll="so-expforcing">Driven oscillator</a></li>
<li><a href="so-laplace.html" data-scroll="so-laplace">Laplace transform methods</a></li>
<li><a href="so-laplace-repeated.html" data-scroll="so-laplace-repeated">Repeated and complex poles</a></li>
<li><a href="so-convolutions.html" data-scroll="so-convolutions">Convolutions</a></li>
</ul>
</li>
<li class="link">
<a href="nonlinear-systems.html" data-scroll="nonlinear-systems"><span class="codenumber">5</span> <span class="title">Nonlinear ODEs</span></a><ul>
<li><a href="nl-autonomous.html" data-scroll="nl-autonomous">Autonomous scalar problems</a></li>
<li><a href="nl-separable.html" data-scroll="nl-separable">Separable equations</a></li>
<li><a href="nl-logistic.html" data-scroll="nl-logistic">Case study: Logistic equation</a></li>
<li><a href="nl-directionfields.html" data-scroll="nl-directionfields">Direction fields</a></li>
<li><a href="nl-linearization.html" data-scroll="nl-linearization">Linearization</a></li>
</ul>
</li>
<li class="link"><a href="backmatter-1.html" data-scroll="backmatter-1"><span class="title">Back Matter</span></a></li>
<li class="link"><a href="index-1.html" data-scroll="index-1"><span class="title">Index</span></a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="fl-undeter"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">2.6</span> <span class="title">Undetermined coefficients</span>
</h2>
<a href="fl-undeter.html" class="permalink">¶</a><section class="introduction" id="introduction-7"><p id="p-223">For this section we will limit <a data-knowl="./knowl/fl-eq-linear.html" title="Equation 2.2.1">(2.2.1)</a> to the important special case when (1) the growth/decay rate coefficient \(a(t)\) is constant, and (2) the forcing function is a polynomial, exponential, sin, or cos, or a combination of these. In this situation, the form of \(x_p\) can be written down immediately with some unknown or <dfn class="terminology">undetermined coefficients</dfn>, which are then found by substitution into the ODE. The correct form of \(x_p\) for various \(f\) are given in <a data-knowl="./knowl/fl-tb-undeter.html" title="Table 2.6.1: Particular solutions for undetermined coefficients">Table 2.6.1</a>.</p>
<figure class="table figure-like" id="fl-tb-undeter"><table>
<tr>
<td class="l m b0 r0 l0 t0 lines">\(\mathbf{f(t)}\)</td>
<td class="l m b0 r0 l0 t0 lines">\(\mathbf{x_p(t)}\)</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">\(b_nt^n + \cdots b_0\)</td>
<td class="l m b0 r0 l0 t0 lines">\(B_nt^n + \cdots + B_0\)</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">\(e^{rt}(b_nt^n + \cdots b_0)\)</td>
<td class="l m b0 r0 l0 t0 lines">\(e^{rt}(B_nt^n + \cdots B_0)\)</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">\(\cos(\omega t)\)</td>
<td class="l m b0 r0 l0 t0 lines">\(A \cos(\omega t) + B \sin(\omega t)\)</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">\(\sin(\omega t)\)</td>
<td class="l m b0 r0 l0 t0 lines">\(A \cos(\omega t) + B \sin(\omega t)\)</td>
</tr>
</table>
<figcaption><span class="type">Table</span> <span class="codenumber">2.6.1.</span> Particular solutions for undetermined coefficients</figcaption></figure><article class="example example-like" id="example-34"><a data-knowl="" class="id-ref" data-refid="hk-example-34"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.6.2</span>.</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-34"><article class="example example-like"><p id="p-224">To solve \(x'+3x=6t\text{,}\) first note that \(x_h(t)=c_1e^{-3t}\text{.}\) For \(x_p\) we use the educated guess</p>
<div class="displaymath">
\begin{equation*}
x_p(t) = B_1 t + B_0\text{.}
\end{equation*}
</div>
<p>Substituting that into the ODE yields</p>
<div class="displaymath">
\begin{equation*}
(B_1)+3(B_1 t + B_0) = 6t\text{.}
\end{equation*}
</div>
<p>On matching like powers of \(t\) we get the equations \(3B_1=6\) and \(B_1+B_0=0\text{.}\) This is a linear system of two equations with two unknowns, but we don't need any fancy linear algebra to see that \(B_1=2\) and \(B_0=-2\text{.}\) So the general solution is</p>
<div class="displaymath">
\begin{equation*}
x(t) = c_1 e^{-3t} + 2t - 2\text{.}
\end{equation*}
</div></article></div>
<article class="example example-like" id="example-35"><a data-knowl="" class="id-ref" data-refid="hk-example-35"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.6.3</span>.</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-35"><article class="example example-like"><p id="p-225">To solve \(x'+x=-te^t\text{,}\) first note that \(x_h(t)=c_1e^{-t}\text{.}\) For \(x_p\) we use the educated guess</p>
<div class="displaymath">
\begin{equation*}
x_p(t) = (B_1 t + B_0)e^t\text{.}
\end{equation*}
</div>
<p>Substituting that into the ODE yields</p>
<div class="displaymath">
\begin{equation*}
B_1e^t + (B_1 t + B_0)e^t = -te^t\text{.}
\end{equation*}
</div>
<p>On cancelling the exponentials and matching like powers of \(t\text{,}\) we get the equations \(B_1=-1\) and \(B_1+B_0=0\text{.}\) Hence \(B_1=-1\) and \(B_0=1\text{.}\) So the general solution is</p>
<div class="displaymath">
\begin{equation*}
x(t) = c_1 e^{-t} + e^t(1-t)\text{.}
\end{equation*}
</div></article></div>
<p id="p-226">An important aspect of the previous two examples is that if the forcing function \(f\) includes a polynomial, then the particular solution has to include all the terms for a polynomial of the same degree, even if the forcing polynomial has some zero coefficients.</p>
<article class="example example-like" id="example-36"><a data-knowl="" class="id-ref" data-refid="hk-example-36"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.6.4</span>.</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-36"><article class="example example-like"><p id="p-227">Let's solve \(x'=3x+50\cos(4t)\text{.}\) We have \(x_h=c_1e^{3t}\) and choose</p>
<div class="displaymath">
\begin{equation*}
x_p = A \cos(4t) + B\sin(4t)\text{.}
\end{equation*}
</div>
<p>Put this into the ODE to get</p>
<div class="displaymath">
\begin{equation*}
[-4A\sin(4t) + 4B\cos(4t)] - 3[A \cos(4t) + B\sin(4t)] = 50\cos(4t)\text{.}
\end{equation*}
</div>
<p>Matching the coefficients of cosine and sine leads to</p>
<div class="displaymath">
\begin{equation*}
4B-3A = 50, \quad -4A-3B = 0\text{.}
\end{equation*}
</div>
<p>This is the linear system</p>
<div class="displaymath">
\begin{equation*}
\twomat{-3}{4}{-4}{-3} \twovec{A}{B} = \twovec{50}{0}\text{.}
\end{equation*}
</div>
<p>We apply Cramer's Rule to get</p>
<div class="displaymath">
\begin{equation*}
A = \frac{ \twodet{50}{4}{0}{-3} }{9+16} = -6, \quad B = \frac{ \twodet{-3}{50}{-4}{0} }{9+16} = 8\text{.}
\end{equation*}
</div>
<p>Thus finally</p>
<div class="displaymath">
\begin{equation*}
x(t) = c_1e^{3t} + 8\cos(4t) - 6 \sin(4t) \text{.}
\end{equation*}
</div></article></div></section><section class="subsection" id="fl-uc-breakdown"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.6.1</span> <span class="title">Breakdown of the method</span>
</h3>
<a href="fl-undeter.html#fl-uc-breakdown" class="permalink">¶</a><p id="p-228">The suggestions in <a data-knowl="./knowl/fl-tb-undeter.html" title="Table 2.6.1: Particular solutions for undetermined coefficients">Table 2.6.1</a> can fail if the forcing \(f\) includes the homogeneous solution \(e^{at}\text{.}\)</p>
<article class="example example-like" id="example-37"><a data-knowl="" class="id-ref" data-refid="hk-example-37"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.6.5</span>.</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-37"><article class="example example-like"><p id="p-229">Consider \(x'-ax=e^{at}\text{.}\) We get \(x_h=c_1e^{at}\text{,}\) and the table suggests</p>
<div class="displaymath">
\begin{equation*}
x_p = B_0 e^{at}\text{.}
\end{equation*}
</div>
<p>But this is a repeat of the homogeneous solution. Hence if we substitute it into \(x'-ax\text{,}\) we (naturally) get zero, and it's impossible to match this with the forcing function \(e^{at}\text{.}\)</p></article></div>
<p id="p-230">The example above is a failure of the method, not a statement about the existence of the solution. There are advanced rules for fixing the method of undetermined coefficients in this circumstance, but it's easier to just fall back to variation of parameters, as shown in <a href="fl-varparam.html" class="internal" title="Section 2.5: Variation of parameters">Section 2.5</a>.</p>
<article class="example example-like" id="example-38"><a data-knowl="" class="id-ref" data-refid="hk-example-38"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.6.6</span>.</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-38"><article class="example example-like"><p id="p-231">We solve \(x'-ax=e^{at}\) by the variation of parameters formula</p>
<div class="displaymath">
\begin{equation*}
x(t) = c_1 g(t) + g(t) \int g(t)^{-1} e^{at} \, dt \text{,}
\end{equation*}
</div>
<p>where</p>
<div class="displaymath">
\begin{equation*}
g(t) = \exp \left( \int a\, dt \right) = e^{at}\text{.}
\end{equation*}
</div>
<p>Hence</p>
<div class="displaymath">
\begin{equation*}
x(t) = c_1 e^{at} + e^{at} \int e^{-at} e^{at} \, dt = c_1 e^{at} + t e^{at}\text{.}
\end{equation*}
</div></article></div></section></section></div></main>
</div>
<div class="login-link"><span id="loginlogout" class="login">login</span></div>
<script src="https://pretextbook.org/js/0.12/login.js"></script>
</body>
</html>
